const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-CydSDO_4.js","assets/index-BjfinGfq.js","assets/ui-DzcvAssw.js","assets/vendor-CfX-nNg5.js","assets/index-BqGu-06a.css","assets/slicedToArray-w3y9pYby.js"])))=>i.map(i=>d[i]);
import{c as W,v as Mr,t as Qn,a as Lr,p as ei,b as ti,P as oe,d as vs,u as pe,e as ri,f as bs,g as je,h as si,i as zr,j as br,k as ni,l as ii,V as ai,m as ae,n as oi,o as li,q as ci,R as di,F as ui,D as mi,r as Pe,s as Wt,w as Ht,x as at,y as hi,z as ws,A as fi,B as pi,C as gi,E as xi,I as yi,G as vi,_ as $r}from"./index-BjfinGfq.js";import{j as n,X as wr,x as nr,s as ks,A as kt,m as Q,F as bi,w as wi,v as ir,Q as Ze,z as ki,ad as ji,p as ct,T as Si,n as js,r as Ss,q as dt,ae as jt,a8 as ut,af as Ni,a1 as Ci,ag as Fr,ab as _i,aa as Br,V as Ri,c as Ai,ah as Pi,ai as Ei}from"./ui-DzcvAssw.js";import{a as h,f as Ot,c as Ii}from"./vendor-CfX-nNg5.js";import{M as Oi,T as Ti}from"./TrainingReminderBanner-BvYnbVKY.js";import{u as kr,s as Di,m as Mi,a as Li,i as Vr,S as zi,b as Tt,c as ar,r as $i,D as jr,d as Ns,R as Fi,e as Bi,f as Vi,g as Wi,h as Hi,Z as Sr,G as Ui,j as Cs,k as Ki,l as Gi,n as qi,o as St,p as Yi,q as _s,L as Nt,t as Xi,v as Zi,w as Ji,x as Wr,y as Rs,z as Qi,A as As,B as ea,J as ta,C as De,E as ra,F as sa,H as na,I as ia,K as aa,M as Hr,N as ze,O as oa,P as la,Q as Je,T as Qe,U as tt,V as ca,W as Ps,X as Es,Y as Is,_ as da,$ as ua,a0 as Ur,a1 as ma,a2 as ha,a3 as Kr,a4 as fa,a5 as or,a6 as pa,a7 as ga,a8 as Ut,a9 as Kt,aa as Gt,ab as qt,ac as Yt}from"./CartesianChart-CIQiFx3T.js";function Ye(e,r,t){let s=t.initialDeps??[],i;function a(){var o,l,c,d;let f;t.key&&((o=t.debug)!=null&&o.call(t))&&(f=Date.now());const u=e();if(!(u.length!==s.length||u.some((b,v)=>s[v]!==b)))return i;s=u;let w;if(t.key&&((l=t.debug)!=null&&l.call(t))&&(w=Date.now()),i=r(...u),t.key&&((c=t.debug)!=null&&c.call(t))){const b=Math.round((Date.now()-f)*100)/100,v=Math.round((Date.now()-w)*100)/100,m=v/16,p=(x,j)=>{for(x=String(x);x.length<j;)x=" "+x;return x};console.info(`%c⏱ ${p(v,5)} /${p(b,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*m,120))}deg 100% 31%);`,t?.key)}return(d=t?.onChange)==null||d.call(t,i),i}return a.updateDeps=o=>{s=o},a}function Gr(e,r){if(e===void 0)throw new Error("Unexpected undefined");return e}const xa=(e,r)=>Math.abs(e-r)<1.01,ya=(e,r,t)=>{let s;return function(...i){e.clearTimeout(s),s=e.setTimeout(()=>r.apply(this,i),t)}},qr=e=>{const{offsetWidth:r,offsetHeight:t}=e;return{width:r,height:t}},va=e=>e,ba=e=>{const r=Math.max(e.startIndex-e.overscan,0),t=Math.min(e.endIndex+e.overscan,e.count-1),s=[];for(let i=r;i<=t;i++)s.push(i);return s},wa=(e,r)=>{const t=e.scrollElement;if(!t)return;const s=e.targetWindow;if(!s)return;const i=o=>{const{width:l,height:c}=o;r({width:Math.round(l),height:Math.round(c)})};if(i(qr(t)),!s.ResizeObserver)return()=>{};const a=new s.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c?.borderBoxSize){const d=c.borderBoxSize[0];if(d){i({width:d.inlineSize,height:d.blockSize});return}}i(qr(t))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return a.observe(t,{box:"border-box"}),()=>{a.unobserve(t)}},Yr={passive:!0},Xr=typeof window>"u"?!0:"onscrollend"in window,ka=(e,r)=>{const t=e.scrollElement;if(!t)return;const s=e.targetWindow;if(!s)return;let i=0;const a=e.options.useScrollendEvent&&Xr?()=>{}:ya(s,()=>{r(i,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:u,isRtl:g}=e.options;i=u?t.scrollLeft*(g&&-1||1):t.scrollTop,a(),r(i,f)},l=o(!0),c=o(!1);c(),t.addEventListener("scroll",l,Yr);const d=e.options.useScrollendEvent&&Xr;return d&&t.addEventListener("scrollend",c,Yr),()=>{t.removeEventListener("scroll",l),d&&t.removeEventListener("scrollend",c)}},ja=(e,r,t)=>{if(r?.borderBoxSize){const s=r.borderBoxSize[0];if(s)return Math.round(s[t.options.horizontal?"inlineSize":"blockSize"])}return e[t.options.horizontal?"offsetWidth":"offsetHeight"]},Sa=(e,{adjustments:r=0,behavior:t},s)=>{var i,a;const o=e+r;(a=(i=s.scrollElement)==null?void 0:i.scrollTo)==null||a.call(i,{[s.options.horizontal?"left":"top"]:o,behavior:t})};class Na{constructor(r){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let t=null;const s=()=>t||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:t=new this.targetWindow.ResizeObserver(i=>{i.forEach(a=>{const o=()=>{this._measureElement(a.target,a)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var i;(i=s())==null||i.disconnect(),t=null},observe:i=>{var a;return(a=s())==null?void 0:a.observe(i,{box:"border-box"})},unobserve:i=>{var a;return(a=s())==null?void 0:a.unobserve(i)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([s,i])=>{typeof i>"u"&&delete t[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:va,rangeExtractor:ba,onChange:()=>{},measureElement:ja,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...t}},this.notify=t=>{var s,i;(i=(s=this.options).onChange)==null||i.call(s,this,t)},this.maybeNotify=Ye(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var t;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.maybeNotify();return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((t=this.scrollElement)==null?void 0:t.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,a)=>{this.scrollAdjustments=0,this.scrollDirection=a?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=a,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(t,s)=>{const i=new Map,a=new Map;for(let o=s-1;o>=0;o--){const l=t[o];if(i.has(l.lane))continue;const c=a.get(l.lane);if(c==null||l.end>c.end?a.set(l.lane,l):l.end<c.end&&i.set(l.lane,!0),i.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=Ye(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(t,s,i,a,o)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:s,scrollMargin:i,getItemKey:a,enabled:o}),{key:!1}),this.getMeasurements=Ye(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:s,scrollMargin:i,getItemKey:a,enabled:o},l)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(f=>{this.itemSizeCache.set(f.key,f.size)}));const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const d=this.measurementsCache.slice(0,c);for(let f=c;f<t;f++){const u=a(f),g=this.options.lanes===1?d[f-1]:this.getFurthestMeasurement(d,f),w=g?g.end+this.options.gap:s+i,b=l.get(u),v=typeof b=="number"?b:this.options.estimateSize(f),m=w+v,p=g?g.lane:f%this.options.lanes;d[f]={index:f,start:w,size:v,end:m,key:u,lane:p}}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Ye(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(t,s,i,a)=>this.range=t.length>0&&s>0?Ca({measurements:t,outerSize:s,scrollOffset:i,lanes:a}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Ye(()=>{let t=null,s=null;const i=this.calculateRange();return i&&(t=i.startIndex,s=i.endIndex),this.maybeNotify.updateDeps([this.isScrolling,t,s]),[this.options.rangeExtractor,this.options.overscan,this.options.count,t,s]},(t,s,i,a,o)=>a===null||o===null?[]:t({startIndex:a,endIndex:o,overscan:s,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const s=this.options.indexAttribute,i=t.getAttribute(s);return i?parseInt(i,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(t,s)=>{const i=this.indexFromElement(t),a=this.measurementsCache[i];if(!a)return;const o=a.key,l=this.elementsCache.get(o);l!==t&&(l&&this.observer.unobserve(l),this.observer.observe(t),this.elementsCache.set(o,t)),t.isConnected&&this.resizeItem(i,this.options.measureElement(t,s,this))},this.resizeItem=(t,s)=>{const i=this.measurementsCache[t];if(!i)return;const a=this.itemSizeCache.get(i.key)??i.size,o=s-a;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,o,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,s)),this.notify(!1))},this.measureElement=t=>{if(!t){this.elementsCache.forEach((s,i)=>{s.isConnected||(this.observer.unobserve(s),this.elementsCache.delete(i))});return}this._measureElement(t,void 0)},this.getVirtualItems=Ye(()=>[this.getVirtualIndexes(),this.getMeasurements()],(t,s)=>{const i=[];for(let a=0,o=t.length;a<o;a++){const l=t[a],c=s[l];i.push(c)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const s=this.getMeasurements();if(s.length!==0)return Gr(s[Os(0,s.length-1,i=>Gr(s[i]).start,t)])},this.getOffsetForAlignment=(t,s,i=0)=>{const a=this.getSize(),o=this.getScrollOffset();s==="auto"&&(s=t>=o+a?"end":"start"),s==="center"?t+=(i-a)/2:s==="end"&&(t-=a);const l=this.getTotalSize()+this.options.scrollMargin-a;return Math.max(Math.min(l,t),0)},this.getOffsetForIndex=(t,s="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const i=this.measurementsCache[t];if(!i)return;const a=this.getSize(),o=this.getScrollOffset();if(s==="auto")if(i.end>=o+a-this.options.scrollPaddingEnd)s="end";else if(i.start<=o+this.options.scrollPaddingStart)s="start";else return[o,s];const l=s==="end"?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,s,i.size),s]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(t,{align:s="start",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,s),{adjustments:void 0,behavior:i})},this.scrollToIndex=(t,{align:s="auto",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t=Math.max(0,Math.min(t,this.options.count-1));let a=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(t,d);if(!f){console.warn("Failed to get offset for index:",t);return}const[u,g]=f;this._scrollToOffset(u,{adjustments:void 0,behavior:i}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),b=this.getOffsetForIndex(t,g);if(!b){console.warn("Failed to get offset for index:",t);return}xa(b[0],w)||c(g)})},c=d=>{this.targetWindow&&(a++,a<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${t} after ${o} attempts.`))};l(s)},this.scrollBy=(t,{behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+t,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var t;const s=this.getMeasurements();let i;if(s.length===0)i=this.options.paddingStart;else if(this.options.lanes===1)i=((t=s[s.length-1])==null?void 0:t.end)??0;else{const a=Array(this.options.lanes).fill(null);let o=s.length-1;for(;o>=0&&a.some(l=>l===null);){const l=s[o];a[l.lane]===null&&(a[l.lane]=l.end),o--}i=Math.max(...a.filter(l=>l!==null))}return Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(t,{adjustments:s,behavior:i})=>{this.options.scrollToFn(t,{behavior:i,adjustments:s},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(r)}}const Os=(e,r,t,s)=>{for(;e<=r;){const i=(e+r)/2|0,a=t(i);if(a<s)e=i+1;else if(a>s)r=i-1;else return i}return e>0?e-1:0};function Ca({measurements:e,outerSize:r,scrollOffset:t,lanes:s}){const i=e.length-1,a=c=>e[c].start;if(e.length<=s)return{startIndex:0,endIndex:i};let o=Os(0,i,a,t),l=o;if(s===1)for(;l<i&&e[l].end<t+r;)l++;else if(s>1){const c=Array(s).fill(0);for(;l<i&&c.some(f=>f<t+r);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(s).fill(t+r);for(;o>=0&&d.some(f=>f>=t);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%s),l=Math.min(i,l+(s-1-l%s))}return{startIndex:o,endIndex:l}}const Zr=typeof document<"u"?h.useLayoutEffect:h.useEffect;function _a(e){const r=h.useReducer(()=>({}),{})[1],t={...e,onChange:(i,a)=>{var o;a?Ot.flushSync(r):r(),(o=e.onChange)==null||o.call(e,i,a)}},[s]=h.useState(()=>new Na(t));return s.setOptions(t),Zr(()=>s._didMount(),[]),Zr(()=>s._willUpdate()),s}function Ra(e){return _a({observeElementRect:wa,observeElementOffset:ka,scrollToFn:Sa,...e})}const Aa=({data:e,mappedColumns:r,validationErrors:t,onClose:s,onConfirm:i,onUpdateMapping:a})=>{const[o,l]=h.useState(null),[c,d]=h.useState(!1);h.useEffect(()=>{const m=Object.values(r).some(p=>p.toLowerCase()==="status");d(m)},[r]);const f=e.length>0?Object.keys(e[0]):[],u=["full_name","structure_name","section_name","position","sex","status","age","tenure","last_salary_increase","last_position_change","vacation_usage_rate","one_or_two_day_vacations","last_debt_10","last_debt_90","total_trainings","total_personal_cost_azn","position_level","performance_rating_latest","employee_cost","report_date"],g=(m,p)=>{a(m,p),l(null)},w=m=>t[m]&&t[m].length>0?"error":r[m]?"mapped":"unmapped",b=m=>{const p=w(m);return W("px-3 py-2 text-left text-xs font-medium uppercase tracking-wider cursor-pointer",p==="error"?"text-red-600 bg-red-50":p==="mapped"?"text-app-green bg-app-green-light":"text-gray-500 bg-gray-50")},v=m=>{const p=w(m);return W("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",p==="error"?"bg-red-100 text-red-800":p==="mapped"?"bg-app-green-light text-app-green":"bg-gray-100 text-gray-800")};return n.jsxs("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden max-w-6xl w-full max-h-[80vh] flex flex-col",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Data Preview and Column Mapping"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Verify your data and map columns to the correct fields"})]}),n.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500 transition-colors",children:n.jsx(wr,{size:24})})]}),n.jsx("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[c?n.jsxs("div",{className:"flex items-center text-app-green",children:[n.jsx(ks,{size:16,className:"mr-1"}),n.jsx("span",{className:"text-sm font-medium",children:"Status column is mapped"})]}):n.jsxs("div",{className:"flex items-center text-amber-600",children:[n.jsx(nr,{size:16,className:"mr-1"}),n.jsx("span",{className:"text-sm font-medium",children:"Status column is required"})]}),Object.keys(t).length>0&&n.jsxs("div",{className:"flex items-center text-red-600",children:[n.jsx(nr,{size:16,className:"mr-1"}),n.jsxs("span",{className:"text-sm font-medium",children:[Object.keys(t).length," column(s) with validation issues"]})]})]}),n.jsx("button",{onClick:i,disabled:!c,className:W("px-4 py-2 text-sm font-medium rounded-md",c?"bg-app-green text-white hover:bg-app-green-hover":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Confirm and Upload"})]})}),n.jsx("div",{className:"flex-1 overflow-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:n.jsx("tr",{children:f.map(m=>n.jsxs("th",{scope:"col",className:b(m),onClick:()=>l(m===o?null:m),children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:m}),n.jsx("div",{className:v(m),children:r[m]||"Not mapped"})]}),o===m&&n.jsx("div",{className:"absolute mt-1 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-20",children:n.jsxs("div",{className:"py-1 max-h-60 overflow-auto",children:[n.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 bg-gray-50 sticky top-0",children:"Map to standard column:"}),u.map(p=>n.jsx("button",{className:W("block w-full text-left px-4 py-2 text-sm hover:bg-gray-100",r[m]===p?"bg-app-green-light text-app-green":"text-gray-700"),onClick:()=>g(m,p),children:p},p)),n.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:n.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",onClick:()=>g(m,""),children:"Clear mapping"})})]})}),t[m]&&t[m].length>0&&n.jsx("div",{className:"text-xs text-red-600 mt-1",children:t[m][0]})]},m))})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.slice(0,10).map((m,p)=>n.jsx("tr",{className:p%2===0?"bg-white":"bg-gray-50",children:f.map(x=>n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:m[x]!==void 0&&m[x]!==null?String(m[x]):""},`${p}-${x}`))},p))})]})}),n.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-200 text-xs text-gray-500",children:["Showing preview of first 10 rows out of ",e.length," total rows"]})]})};function Pa({show:e,onClose:r,onUploadSuccess:t,defaultTab:s="employee"}){const[i,a]=h.useState(s),[o,l]=h.useState(null),[c,d]=h.useState(!1),[f,u]=h.useState(null),[g,w]=h.useState(!1),[b,v]=h.useState([]),[m,p]=h.useState(!1),[x,j]=h.useState({}),[k,C]=h.useState({}),[y,N]=h.useState(!1),[_,A]=h.useState(0);h.useEffect(()=>{e||(l(null),u(null),v([]),p(!1),j({}),C({}),a(s))},[e,s]),h.useEffect(()=>{l(null),u(null),v([]),p(!1),j({}),C({})},[i]);const E=R=>{R.preventDefault(),R.stopPropagation(),R.type==="dragenter"||R.type==="dragover"?w(!0):R.type==="dragleave"&&w(!1)},L=R=>{R.preventDefault(),R.stopPropagation(),w(!1),R.dataTransfer.files&&R.dataTransfer.files[0]&&$(R.dataTransfer.files[0])},O=R=>{R.target.files&&R.target.files[0]&&$(R.target.files[0])},$=async R=>{const D=["text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"],H=[".csv",".xlsx",".xls"],se=R.name.substring(R.name.lastIndexOf(".")).toLowerCase();if(!D.includes(R.type)&&!H.includes(se)){u("Please upload a CSV or Excel file");return}l(R),u(null);try{N(!0),A(10);const G=await ei(R);if(A(50),G.error){u(G.error),N(!1);return}if(G.data.length===0){u("The file contains no data"),N(!1);return}v(G.data),A(70);const ee=ti(G.columns);j(ee),A(90);const te=Mr(G.data,ee);C(te.errors),A(100),N(!1),p(!0)}catch(G){console.error("Error parsing file:",G),u(`Error parsing file: ${G instanceof Error?G.message:"Unknown error"}`),N(!1)}},T=(R,D)=>{const H={...x};D?H[R]=D:delete H[R],j(H);const se=Mr(b,H);C(se.errors)},V=()=>{p(!1)},z=async()=>{if(!o){u("Please select a file to upload");return}if(i==="employee"){if(!Object.values(x).some(D=>D.toLowerCase()==="status")){u('Status column is required. Please map a column to "status".');return}}else if(i==="engagement"&&!Object.values(x).some(D=>D.toLowerCase().includes("employee")||D.toLowerCase().includes("id"))){u("Employee ID column is required for engagement surveys.");return}d(!0),u(null);try{const R=Qn(b,x),D=new FormData;D.append("file",o);const H=JSON.stringify(R);if(H.length>10*1024*1024){const te=[];for(let X=0;X<R.length;X+=1e3)te.push(R.slice(X,X+1e3));D.append("mappedData",JSON.stringify(te[0])),D.append("totalChunks",String(te.length)),D.append("currentChunk","0")}else D.append("mappedData",H);const se=i==="engagement"?"/api/data/upload/engagement":"/api/data/upload/confirm";D.append("dataType",i);const G=await Lr.post(se,D,{headers:{"Content-Type":"multipart/form-data"}});if(G.data.error)throw new Error(G.data.error);if(H.length>10*1024*1024){const ee=[];for(let X=0;X<R.length;X+=1e3)ee.push(R.slice(X,X+1e3));for(let X=1;X<ee.length;X++){const le=new FormData;le.append("mappedData",JSON.stringify(ee[X])),le.append("totalChunks",String(ee.length)),le.append("currentChunk",String(X)),le.append("uploadId",G.data.uploadId),console.log(`Uploading chunk ${X+1} of ${ee.length}`);const M=await Lr.post("/api/data/upload-chunk",le,{});if(M.data.error)throw new Error(M.data.error)}}try{console.log("Clearing all caches..."),sessionStorage.clear()}catch(ee){console.error("Error clearing cache:",ee)}d(!1),l(null),p(!1),v([]),j({}),t&&t(),r()}catch(R){console.error("Upload error:",R),d(!1);let D="An unknown error occurred during upload";R instanceof Error&&(D=R.message,D.startsWith("Validation Failed: Missing MANDATORY columns")?D+=" Please ensure the required column names match exactly (case-insensitive) and do not contain extra spaces. Required columns are typically: hr_code, full_name, structure_name, position, status, tenure, employee_cost.":R.message.includes("Failed to fetch")||R.message.includes("timeout")?D=`Network Error: ${R.message}. Please check your connection and try again.`:R.message.includes("file type")&&(D="Invalid file type. Please upload a CSV or Excel file (.csv, .xlsx, .xls).")),u(D)}},B=()=>{window.open("/api/data/download-template","_blank","noopener,noreferrer")};return e?m&&b.length>0?n.jsx(kt,{children:n.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:n.jsx(Aa,{data:b,mappedColumns:x,validationErrors:k,onClose:V,onConfirm:z,onUpdateMapping:T})})}):n.jsx(kt,{children:e&&n.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:n.jsxs(Q.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-lg w-full p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Upload Data"}),n.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 transition-colors",children:n.jsx(wr,{size:24})})]}),n.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-6",children:[n.jsxs("button",{onClick:()=>a("employee"),className:W("relative py-2 px-4 text-sm font-medium transition-colors duration-200 focus:outline-none",i==="employee"?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:["Employee Data",i==="employee"&&n.jsx(Q.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400",layoutId:"uploadTabIndicator",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]}),n.jsxs("button",{onClick:()=>a("engagement"),className:W("relative py-2 px-4 text-sm font-medium transition-colors duration-200 focus:outline-none",i==="engagement"?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:["Engagement Surveys",i==="engagement"&&n.jsx(Q.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400",layoutId:"uploadTabIndicator",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-app-green-light dark:bg-app-green-darkmode-light border border-app-green/20 dark:border-app-green-darkmode/30 rounded-lg p-4",children:[n.jsx("h3",{className:"text-sm font-medium text-app-green dark:text-app-green-darkmode mb-2",children:"Instructions"}),i==="employee"?n.jsxs("ul",{className:"text-sm text-app-green dark:text-app-green-darkmode space-y-1",children:[n.jsx("li",{children:"Upload your employee data in CSV or Excel format"}),n.jsxs("li",{children:["File must contain a ",n.jsx("strong",{children:"Status"})," column"]}),n.jsx("li",{children:"You'll be able to map columns before final upload"}),n.jsx("li",{children:"Maximum file size: 10MB"})]}):n.jsxs("ul",{className:"text-sm text-app-green dark:text-app-green-darkmode space-y-1",children:[n.jsx("li",{children:"Upload engagement survey data in CSV or Excel format"}),n.jsx("li",{children:"Include columns like: employee_id, survey_date, satisfaction_score"}),n.jsx("li",{children:"Optional columns: work_life_balance, career_development, management_rating"}),n.jsx("li",{children:"Data will be used for Deep Analysis correlations"}),n.jsx("li",{children:"Maximum file size: 10MB"})]})]}),n.jsxs("div",{onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:L,className:W("border-2 border-dashed rounded-lg p-8 text-center transition-colors",g?"border-app-green bg-app-green-light dark:bg-app-green-darkmode-light":"border-gray-300 dark:border-gray-600 hover:border-app-green dark:hover:border-app-green-darkmode"),children:[n.jsx("input",{type:"file",onChange:O,accept:".csv,.xlsx,.xls",className:"hidden",id:"file-upload",disabled:y||c}),n.jsx("label",{htmlFor:"file-upload",className:W("cursor-pointer flex flex-col items-center",(y||c)&&"opacity-50 pointer-events-none"),children:y?n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-app-green dark:border-app-green-darkmode border-t-transparent rounded-full animate-spin mb-4"}),n.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Parsing file... ",_,"%"]})]}):o?n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx(bi,{size:32,className:"mb-4 text-app-green dark:text-app-green-darkmode"}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:o.name}),n.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(o.size/1024/1024).toFixed(2)," MB"]}),n.jsx("button",{type:"button",onClick:()=>l(null),className:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 mt-2",children:"Remove"})]})]}):n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx(wi,{size:32,className:"mb-4 text-gray-400 dark:text-gray-500"}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Drag and drop your file here or click to browse"}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Supports CSV and Excel files"})]})]})})]}),f&&n.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400 text-sm",children:[n.jsx(nr,{size:16}),n.jsx("p",{children:f})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4",children:[n.jsxs("button",{onClick:B,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",children:[n.jsx(ir,{size:16,className:"mr-2"}),"Download Template"]}),n.jsxs("div",{className:"space-x-3",children:[n.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100",disabled:c||y,children:"Cancel"}),n.jsx("button",{onClick:()=>o&&p(!0),disabled:!o||c||y,className:W("px-4 py-2 text-sm font-medium text-white rounded-lg transition-all",!o||c||y?"bg-gray-400 dark:bg-gray-600 cursor-not-allowed":"bg-app-green hover:bg-app-green-hover dark:bg-app-green-darkmode dark:hover:bg-app-green-darkmode-hover"),children:y?"Parsing...":"Preview Data"})]})]})]})]})})}):null}const Ea=({show:e,message:r,onClose:t})=>(h.useEffect(()=>{if(e){const s=setTimeout(()=>{t()},3e4);return()=>clearTimeout(s)}},[e,t]),n.jsx(kt,{children:e&&n.jsx(Q.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:"fixed top-5 left-1/2 transform -translate-x-1/2 z-50 max-w-md w-full mx-4",children:n.jsxs("div",{className:"bg-blue-500 text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[n.jsx(Ze,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("span",{className:"flex-1 text-sm font-medium",children:r}),n.jsx("button",{onClick:t,className:"p-1 hover:bg-blue-600 rounded-full transition-colors",children:n.jsx(wr,{className:"w-4 h-4"})})]})})})),Ia={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"},Oa={primary:"text-app-green",secondary:"text-blue-500",white:"text-white",gray:"text-gray-400"},Ta=({size:e,color:r,className:t})=>n.jsx(ki,{className:`${e} ${r} animate-spin ${t||""}`}),Da=({size:e,color:r})=>{const t=e.includes("w-3")?"w-1 h-1":e.includes("w-4")?"w-1.5 h-1.5":"w-2 h-2";return n.jsx("div",{className:"flex space-x-1",children:[0,1,2].map(s=>n.jsx("div",{className:`${t} ${r.replace("text-","bg-")} rounded-full animate-pulse`,style:{animationDelay:`${s*.1}s`}},s))})},Ma=({size:e,color:r})=>n.jsx("div",{className:`${e} ${r.replace("text-","bg-")} rounded-full animate-pulse`}),La=({size:e,color:r})=>{const t=e.includes("w-3")?"h-3":e.includes("w-4")?"h-4":"h-5";return n.jsx("div",{className:"flex space-x-1 items-end",children:[0,1,2,3].map(s=>n.jsx("div",{className:`w-1 ${t} ${r.replace("text-","bg-")} rounded-sm animate-pulse`,style:{animationDelay:`${s*.1}s`}},s))})};function za({size:e="md",variant:r="spinner",text:t,className:s="",color:i="primary"}){const a=Ia[e],o=Oa[i],l=()=>{switch(r){case"dots":return n.jsx(Da,{size:a,color:o});case"pulse":return n.jsx(Ma,{size:a,color:o});case"bars":return n.jsx(La,{size:a,color:o});default:return n.jsx(Ta,{size:a,color:o,className:s})}};return t?n.jsxs("div",{className:"flex items-center gap-2",children:[l(),n.jsx("span",{className:`text-sm ${o}`,children:t})]}):l()}const $a={PageLoading:({text:e="Loading..."})=>n.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[200px] space-y-3",children:[n.jsx(za,{size:"lg",variant:"spinner",color:"primary"}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e})]})},Fa=({result:e,onExport:r,onDrillDown:t})=>{const[s,i]=h.useState(new Set(["summary"])),[a,o]=h.useState(null),l=u=>{const g=new Set(s);g.has(u)?g.delete(u):g.add(u),i(g)},c=u=>{switch(u){case"churn-patterns":return n.jsx(dt,{className:"w-5 h-5"});case"engagement-correlation":return n.jsx(Ss,{className:"w-5 h-5"});case"cross-source":return n.jsx(ct,{className:"w-5 h-5"});case"organizational-insights":return n.jsx(js,{className:"w-5 h-5"});default:return n.jsx(Ze,{className:"w-5 h-5"})}},d=u=>u>=.8?"text-green-600 dark:text-green-400":u>=.6?"text-blue-600 dark:text-blue-400":u>=.4?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",f=u=>u>=.8?"bg-green-100 dark:bg-green-900/30":u>=.6?"bg-blue-100 dark:bg-blue-900/30":u>=.4?"bg-yellow-100 dark:bg-yellow-900/30":"bg-red-100 dark:bg-red-900/30";return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:c(e.type)}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:e.title}),n.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[n.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.timestamp.toLocaleString()}),n.jsxs("div",{className:W("px-2 py-1 rounded-full text-xs font-medium",f(e.confidence),d(e.confidence)),children:[Math.round(e.confidence*100),"% Confidence"]}),n.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:[e.executionTime,"ms"]})]})]})]}),r&&n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs("button",{onClick:()=>r("pdf"),className:"px-3 py-1.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center space-x-1",children:[n.jsx(ir,{className:"w-3 h-3"}),n.jsx("span",{children:"PDF"})]}),n.jsxs("button",{onClick:()=>r("excel"),className:"px-3 py-1.5 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center space-x-1",children:[n.jsx(ir,{className:"w-3 h-3"}),n.jsx("span",{children:"Excel"})]})]})]}),e.dataSources&&e.dataSources.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:e.dataSources.map((u,g)=>n.jsx("span",{className:"px-2 py-1 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs rounded-md border border-blue-200 dark:border-blue-800",children:u.name},g))}),n.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:n.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:e.summary})})]}),n.jsx(xt,{title:"Key Insights",icon:n.jsx(ji,{className:"w-4 h-4"}),isExpanded:s.has("insights"),onToggle:()=>l("insights"),count:e.insights.length,children:n.jsx("div",{className:"grid gap-4",children:e.insights.map(u=>n.jsx(Ba,{insight:u,onDrillDown:t},u.id))})}),e.visualizations&&e.visualizations.length>0&&n.jsx(xt,{title:"Visualizations",icon:n.jsx(ct,{className:"w-4 h-4"}),isExpanded:s.has("visualizations"),onToggle:()=>l("visualizations"),count:e.visualizations.length,children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.visualizations.map(u=>n.jsx(Va,{visualization:u,isSelected:a===u.id,onSelect:()=>o(u.id)},u.id))})}),e.recommendations&&e.recommendations.length>0&&n.jsx(xt,{title:"Recommendations",icon:n.jsx(Si,{className:"w-4 h-4"}),isExpanded:s.has("recommendations"),onToggle:()=>l("recommendations"),count:e.recommendations.length,children:n.jsx("div",{className:"space-y-4",children:e.recommendations.map(u=>n.jsx(Wa,{recommendation:u},u.id))})}),e.parameters&&n.jsx(xt,{title:"Analysis Parameters",icon:n.jsx(Ze,{className:"w-4 h-4"}),isExpanded:s.has("parameters"),onToggle:()=>l("parameters"),children:n.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:n.jsx("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(e.parameters).map(([u,g])=>{const w=b=>Array.isArray(b)?b.map(v=>typeof v=="object"&&v!==null?Object.entries(v).map(([m,p])=>`${m}: ${p}`).join(", "):String(v)).join(" | "):typeof b=="object"&&b!==null?Object.entries(b).map(([v,m])=>`${v}: ${m}`).join(", "):String(b);return n.jsxs("div",{children:[n.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 capitalize",children:u.replace(/([A-Z])/g," $1").trim()}),n.jsx("dd",{className:"text-sm text-gray-900 dark:text-gray-100 mt-1 break-words",children:w(g)})]},u)})})})})]})},xt=({title:e,icon:r,isExpanded:t,onToggle:s,count:i,children:a})=>n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[n.jsxs("button",{onClick:s,className:"w-full px-6 py-4 flex items-center justify-between text-left hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:r}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e}),i!==void 0&&n.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs rounded-full",children:i})]}),t?n.jsx(jt,{className:"w-5 h-5 text-gray-400"}):n.jsx(ut,{className:"w-5 h-5 text-gray-400"})]}),n.jsx(kt,{children:t&&n.jsx(Q.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:n.jsx("div",{className:"px-6 pb-6",children:a})})})]}),Ba=({insight:e,onDrillDown:r})=>{const t=o=>{switch(o){case"high":return n.jsx(Ci,{className:"w-4 h-4 text-red-500"});case"medium":return n.jsx(Ze,{className:"w-4 h-4 text-yellow-500"});case"low":return n.jsx(ks,{className:"w-4 h-4 text-green-500"});default:return n.jsx(Ze,{className:"w-4 h-4 text-gray-500"})}},s=o=>{switch(o){case"high":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"medium":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"low":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";default:return"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"}},i=o=>o>=.8?"text-green-600 dark:text-green-400":o>=.6?"text-blue-600 dark:text-blue-400":o>=.4?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",a=o=>o>=.8?"bg-green-100 dark:bg-green-900/30":o>=.6?"bg-blue-100 dark:bg-blue-900/30":o>=.4?"bg-yellow-100 dark:bg-yellow-900/30":"bg-red-100 dark:bg-red-900/30";return n.jsxs("div",{className:W("p-4 rounded-lg border",s(e.severity||"low")),children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[t(e.severity||"low"),n.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.title})]}),n.jsx("div",{className:"flex items-center space-x-2",children:e.confidence&&n.jsxs("div",{className:W("px-2 py-1 rounded-full text-xs font-medium",a(e.confidence),i(e.confidence)),children:[Math.round(e.confidence*100),"%"]})})]}),n.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-3",children:e.description}),(e.affectedEmployees||e.departments)&&n.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400 mb-3",children:[e.affectedEmployees&&n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(js,{className:"w-3 h-3"}),n.jsxs("span",{children:[e.affectedEmployees," employees"]})]}),e.departments&&e.departments.length>0&&n.jsxs("span",{children:["Departments: ",e.departments.join(", ")]})]}),r&&n.jsx("button",{onClick:()=>r(e.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium",children:"View Details →"})]})},Va=({visualization:e,isSelected:r,onSelect:t})=>{const s=i=>{switch(i){case"chart":return n.jsx(ct,{className:"w-5 h-5"});case"graph":return n.jsx(Ss,{className:"w-5 h-5"});case"heatmap":return n.jsx(Fr,{className:"w-5 h-5"});case"pie-chart":return n.jsx(Fr,{className:"w-5 h-5"});case"bar-chart":return n.jsx(ct,{className:"w-5 h-5"});default:return n.jsx(ct,{className:"w-5 h-5"})}};return n.jsxs("div",{className:W("p-4 rounded-lg border-2 cursor-pointer transition-all",r?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),onClick:t,children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[n.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:s(e.type)}),n.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.title})]}),n.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[e.type.charAt(0).toUpperCase()+e.type.slice(1)," visualization"]}),n.jsx("div",{className:"h-80 bg-white dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600",children:e.component?n.jsx("div",{className:"w-full h-full p-2",children:n.jsx(e.component,{})}):n.jsx("div",{className:"h-full bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:n.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:[e.type.charAt(0).toUpperCase()+e.type.slice(1)," Visualization"]})})})]})},Wa=({recommendation:e})=>{const r=s=>{switch(s){case"high":return n.jsx(Br,{className:"w-4 h-4 text-red-500"});case"medium":return n.jsx(Br,{className:"w-4 h-4 text-yellow-500"});case"low":return n.jsx(_i,{className:"w-4 h-4 text-green-500"});default:return n.jsx(Ze,{className:"w-4 h-4 text-gray-500"})}},t=s=>{switch(s){case"high":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"medium":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"low":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";default:return"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"}};return n.jsxs("div",{className:W("p-4 rounded-lg border",t(e.priority||"low")),children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[r(e.priority||"low"),n.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.title})]}),n.jsx("div",{className:"flex items-center space-x-2",children:e.priority&&n.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:[e.priority," Priority"]})})]}),n.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-3",children:e.description}),e.actionItems&&e.actionItems.length>0&&n.jsxs("div",{className:"mb-3",children:[n.jsx("h5",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Action Items:"}),n.jsx("ul",{className:"space-y-1",children:e.actionItems.map((s,i)=>n.jsxs("li",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-start",children:[n.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mt-2 mr-2 flex-shrink-0"}),s]},i))})]}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(Ni,{className:"w-3 h-3"}),n.jsx("span",{children:e.estimatedTimeframe})]}),n.jsxs("span",{children:["Impact: ",e.estimatedImpact]})]})]})};let fe;typeof window<"u"?fe=window:typeof self<"u"?fe=self:fe=global;let lr=null,cr=null;const Jr=20,Xt=fe.clearTimeout,Qr=fe.setTimeout,Zt=fe.cancelAnimationFrame||fe.mozCancelAnimationFrame||fe.webkitCancelAnimationFrame,es=fe.requestAnimationFrame||fe.mozRequestAnimationFrame||fe.webkitRequestAnimationFrame;Zt==null||es==null?(lr=Xt,cr=function(r){return Qr(r,Jr)}):(lr=function([r,t]){Zt(r),Xt(t)},cr=function(r){const t=es(function(){Xt(s),r()}),s=Qr(function(){Zt(t),r()},Jr);return[t,s]});function Ha(e){let r,t,s,i,a,o,l;const c=typeof document<"u"&&document.attachEvent;if(!c){o=function(p){const x=p.__resizeTriggers__,j=x.firstElementChild,k=x.lastElementChild,C=j.firstElementChild;k.scrollLeft=k.scrollWidth,k.scrollTop=k.scrollHeight,C.style.width=j.offsetWidth+1+"px",C.style.height=j.offsetHeight+1+"px",j.scrollLeft=j.scrollWidth,j.scrollTop=j.scrollHeight},a=function(p){return p.offsetWidth!==p.__resizeLast__.width||p.offsetHeight!==p.__resizeLast__.height},l=function(p){if(p.target.className&&typeof p.target.className.indexOf=="function"&&p.target.className.indexOf("contract-trigger")<0&&p.target.className.indexOf("expand-trigger")<0)return;const x=this;o(this),this.__resizeRAF__&&lr(this.__resizeRAF__),this.__resizeRAF__=cr(function(){a(x)&&(x.__resizeLast__.width=x.offsetWidth,x.__resizeLast__.height=x.offsetHeight,x.__resizeListeners__.forEach(function(C){C.call(x,p)}))})};let g=!1,w="";s="animationstart";const b="Webkit Moz O ms".split(" ");let v="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m="";{const p=document.createElement("fakeelement");if(p.style.animationName!==void 0&&(g=!0),g===!1){for(let x=0;x<b.length;x++)if(p.style[b[x]+"AnimationName"]!==void 0){m=b[x],w="-"+m.toLowerCase()+"-",s=v[x],g=!0;break}}}t="resizeanim",r="@"+w+"keyframes "+t+" { from { opacity: 0; } to { opacity: 0; } } ",i=w+"animation: 1ms "+t+"; "}const d=function(g){if(!g.getElementById("detectElementResize")){const w=(r||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',b=g.head||g.getElementsByTagName("head")[0],v=g.createElement("style");v.id="detectElementResize",v.type="text/css",e!=null&&v.setAttribute("nonce",e),v.styleSheet?v.styleSheet.cssText=w:v.appendChild(g.createTextNode(w)),b.appendChild(v)}};return{addResizeListener:function(g,w){if(c)g.attachEvent("onresize",w);else{if(!g.__resizeTriggers__){const b=g.ownerDocument,v=fe.getComputedStyle(g);v&&v.position==="static"&&(g.style.position="relative"),d(b),g.__resizeLast__={},g.__resizeListeners__=[],(g.__resizeTriggers__=b.createElement("div")).className="resize-triggers";const m=b.createElement("div");m.className="expand-trigger",m.appendChild(b.createElement("div"));const p=b.createElement("div");p.className="contract-trigger",g.__resizeTriggers__.appendChild(m),g.__resizeTriggers__.appendChild(p),g.appendChild(g.__resizeTriggers__),o(g),g.addEventListener("scroll",l,!0),s&&(g.__resizeTriggers__.__animationListener__=function(j){j.animationName===t&&o(g)},g.__resizeTriggers__.addEventListener(s,g.__resizeTriggers__.__animationListener__))}g.__resizeListeners__.push(w)}},removeResizeListener:function(g,w){if(c)g.detachEvent("onresize",w);else if(g.__resizeListeners__.splice(g.__resizeListeners__.indexOf(w),1),!g.__resizeListeners__.length){g.removeEventListener("scroll",l,!0),g.__resizeTriggers__.__animationListener__&&(g.__resizeTriggers__.removeEventListener(s,g.__resizeTriggers__.__animationListener__),g.__resizeTriggers__.__animationListener__=null);try{g.__resizeTriggers__=!g.removeChild(g.__resizeTriggers__)}catch{}}}}}class Ua extends h.Component{constructor(...r){super(...r),this.state={height:this.props.defaultHeight||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._didLogDeprecationWarning=!1,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:t,disableWidth:s,onResize:i}=this.props;if(this._parentNode){const a=window.getComputedStyle(this._parentNode)||{},o=parseFloat(a.paddingLeft||"0"),l=parseFloat(a.paddingRight||"0"),c=parseFloat(a.paddingTop||"0"),d=parseFloat(a.paddingBottom||"0"),f=this._parentNode.getBoundingClientRect(),u=f.height-c-d,g=f.width-o-l;if(!t&&this.state.height!==u||!s&&this.state.width!==g){this.setState({height:u,width:g});const w=()=>{this._didLogDeprecationWarning||(this._didLogDeprecationWarning=!0,console.warn("scaledWidth and scaledHeight parameters have been deprecated; use width and height instead"))};typeof i=="function"&&i({height:u,width:g,get scaledHeight(){return w(),u},get scaledWidth(){return w(),g}})}}},this._setRef=t=>{this._autoSizer=t}}componentDidMount(){const{nonce:r}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(t!=null&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;const s=t.ownerDocument.defaultView.ResizeObserver;s!=null?(this._resizeObserver=new s(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(t)):(this._detectElementResize=Ha(r),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:r,defaultHeight:t,defaultWidth:s,disableHeight:i=!1,disableWidth:a=!1,doNotBailOutOnEmptyChildren:o=!1,nonce:l,onResize:c,style:d={},tagName:f="div",...u}=this.props,{height:g,width:w}=this.state,b={overflow:"visible"},v={};let m=!1;return i||(g===0&&(m=!0),b.height=0,v.height=g,v.scaledHeight=g),a||(w===0&&(m=!0),b.width=0,v.width=w,v.scaledWidth=w),o&&(m=!1),h.createElement(f,{ref:this._setRef,style:{...b,...d},...u},!m&&r(v))}}function ts(e,[r,t]){return Math.min(t,Math.max(r,e))}var Ka=h.createContext(void 0);function Ga(e){const r=h.useContext(Ka);return e||r||"ltr"}const qa=["top","right","bottom","left"],Me=Math.min,me=Math.max,Ct=Math.round,yt=Math.floor,ke=e=>({x:e,y:e}),Ya={left:"right",right:"left",bottom:"top",top:"bottom"},Xa={start:"end",end:"start"};function dr(e,r,t){return me(e,Me(r,t))}function Ee(e,r){return typeof e=="function"?e(r):e}function Ie(e){return e.split("-")[0]}function rt(e){return e.split("-")[1]}function Nr(e){return e==="x"?"y":"x"}function Cr(e){return e==="y"?"height":"width"}const Za=new Set(["top","bottom"]);function we(e){return Za.has(Ie(e))?"y":"x"}function _r(e){return Nr(we(e))}function Ja(e,r,t){t===void 0&&(t=!1);const s=rt(e),i=_r(e),a=Cr(i);let o=i==="x"?s===(t?"end":"start")?"right":"left":s==="start"?"bottom":"top";return r.reference[a]>r.floating[a]&&(o=_t(o)),[o,_t(o)]}function Qa(e){const r=_t(e);return[ur(e),r,ur(r)]}function ur(e){return e.replace(/start|end/g,r=>Xa[r])}const rs=["left","right"],ss=["right","left"],eo=["top","bottom"],to=["bottom","top"];function ro(e,r,t){switch(e){case"top":case"bottom":return t?r?ss:rs:r?rs:ss;case"left":case"right":return r?eo:to;default:return[]}}function so(e,r,t,s){const i=rt(e);let a=ro(Ie(e),t==="start",s);return i&&(a=a.map(o=>o+"-"+i),r&&(a=a.concat(a.map(ur)))),a}function _t(e){return e.replace(/left|right|bottom|top/g,r=>Ya[r])}function no(e){return{top:0,right:0,bottom:0,left:0,...e}}function Ts(e){return typeof e!="number"?no(e):{top:e,right:e,bottom:e,left:e}}function Rt(e){const{x:r,y:t,width:s,height:i}=e;return{width:s,height:i,top:t,left:r,right:r+s,bottom:t+i,x:r,y:t}}function ns(e,r,t){let{reference:s,floating:i}=e;const a=we(r),o=_r(r),l=Cr(o),c=Ie(r),d=a==="y",f=s.x+s.width/2-i.width/2,u=s.y+s.height/2-i.height/2,g=s[l]/2-i[l]/2;let w;switch(c){case"top":w={x:f,y:s.y-i.height};break;case"bottom":w={x:f,y:s.y+s.height};break;case"right":w={x:s.x+s.width,y:u};break;case"left":w={x:s.x-i.width,y:u};break;default:w={x:s.x,y:s.y}}switch(rt(r)){case"start":w[o]-=g*(t&&d?-1:1);break;case"end":w[o]+=g*(t&&d?-1:1);break}return w}const io=async(e,r,t)=>{const{placement:s="bottom",strategy:i="absolute",middleware:a=[],platform:o}=t,l=a.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(r));let d=await o.getElementRects({reference:e,floating:r,strategy:i}),{x:f,y:u}=ns(d,s,c),g=s,w={},b=0;for(let v=0;v<l.length;v++){const{name:m,fn:p}=l[v],{x,y:j,data:k,reset:C}=await p({x:f,y:u,initialPlacement:s,placement:g,strategy:i,middlewareData:w,rects:d,platform:o,elements:{reference:e,floating:r}});f=x??f,u=j??u,w={...w,[m]:{...w[m],...k}},C&&b<=50&&(b++,typeof C=="object"&&(C.placement&&(g=C.placement),C.rects&&(d=C.rects===!0?await o.getElementRects({reference:e,floating:r,strategy:i}):C.rects),{x:f,y:u}=ns(d,g,c)),v=-1)}return{x:f,y:u,placement:g,strategy:i,middlewareData:w}};async function mt(e,r){var t;r===void 0&&(r={});const{x:s,y:i,platform:a,rects:o,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:f="viewport",elementContext:u="floating",altBoundary:g=!1,padding:w=0}=Ee(r,e),b=Ts(w),m=l[g?u==="floating"?"reference":"floating":u],p=Rt(await a.getClippingRect({element:(t=await(a.isElement==null?void 0:a.isElement(m)))==null||t?m:m.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:d,rootBoundary:f,strategy:c})),x=u==="floating"?{x:s,y:i,width:o.floating.width,height:o.floating.height}:o.reference,j=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),k=await(a.isElement==null?void 0:a.isElement(j))?await(a.getScale==null?void 0:a.getScale(j))||{x:1,y:1}:{x:1,y:1},C=Rt(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:x,offsetParent:j,strategy:c}):x);return{top:(p.top-C.top+b.top)/k.y,bottom:(C.bottom-p.bottom+b.bottom)/k.y,left:(p.left-C.left+b.left)/k.x,right:(C.right-p.right+b.right)/k.x}}const ao=e=>({name:"arrow",options:e,async fn(r){const{x:t,y:s,placement:i,rects:a,platform:o,elements:l,middlewareData:c}=r,{element:d,padding:f=0}=Ee(e,r)||{};if(d==null)return{};const u=Ts(f),g={x:t,y:s},w=_r(i),b=Cr(w),v=await o.getDimensions(d),m=w==="y",p=m?"top":"left",x=m?"bottom":"right",j=m?"clientHeight":"clientWidth",k=a.reference[b]+a.reference[w]-g[w]-a.floating[b],C=g[w]-a.reference[w],y=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let N=y?y[j]:0;(!N||!await(o.isElement==null?void 0:o.isElement(y)))&&(N=l.floating[j]||a.floating[b]);const _=k/2-C/2,A=N/2-v[b]/2-1,E=Me(u[p],A),L=Me(u[x],A),O=E,$=N-v[b]-L,T=N/2-v[b]/2+_,V=dr(O,T,$),z=!c.arrow&&rt(i)!=null&&T!==V&&a.reference[b]/2-(T<O?E:L)-v[b]/2<0,B=z?T<O?T-O:T-$:0;return{[w]:g[w]+B,data:{[w]:V,centerOffset:T-V-B,...z&&{alignmentOffset:B}},reset:z}}}),oo=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var t,s;const{placement:i,middlewareData:a,rects:o,initialPlacement:l,platform:c,elements:d}=r,{mainAxis:f=!0,crossAxis:u=!0,fallbackPlacements:g,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:v=!0,...m}=Ee(e,r);if((t=a.arrow)!=null&&t.alignmentOffset)return{};const p=Ie(i),x=we(l),j=Ie(l)===l,k=await(c.isRTL==null?void 0:c.isRTL(d.floating)),C=g||(j||!v?[_t(l)]:Qa(l)),y=b!=="none";!g&&y&&C.push(...so(l,v,b,k));const N=[l,...C],_=await mt(r,m),A=[];let E=((s=a.flip)==null?void 0:s.overflows)||[];if(f&&A.push(_[p]),u){const T=Ja(i,o,k);A.push(_[T[0]],_[T[1]])}if(E=[...E,{placement:i,overflows:A}],!A.every(T=>T<=0)){var L,O;const T=(((L=a.flip)==null?void 0:L.index)||0)+1,V=N[T];if(V&&(!(u==="alignment"?x!==we(V):!1)||E.every(R=>we(R.placement)===x?R.overflows[0]>0:!0)))return{data:{index:T,overflows:E},reset:{placement:V}};let z=(O=E.filter(B=>B.overflows[0]<=0).sort((B,R)=>B.overflows[1]-R.overflows[1])[0])==null?void 0:O.placement;if(!z)switch(w){case"bestFit":{var $;const B=($=E.filter(R=>{if(y){const D=we(R.placement);return D===x||D==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(D=>D>0).reduce((D,H)=>D+H,0)]).sort((R,D)=>R[1]-D[1])[0])==null?void 0:$[0];B&&(z=B);break}case"initialPlacement":z=l;break}if(i!==z)return{reset:{placement:z}}}return{}}}};function is(e,r){return{top:e.top-r.height,right:e.right-r.width,bottom:e.bottom-r.height,left:e.left-r.width}}function as(e){return qa.some(r=>e[r]>=0)}const lo=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(r){const{rects:t}=r,{strategy:s="referenceHidden",...i}=Ee(e,r);switch(s){case"referenceHidden":{const a=await mt(r,{...i,elementContext:"reference"}),o=is(a,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:as(o)}}}case"escaped":{const a=await mt(r,{...i,altBoundary:!0}),o=is(a,t.floating);return{data:{escapedOffsets:o,escaped:as(o)}}}default:return{}}}}},Ds=new Set(["left","top"]);async function co(e,r){const{placement:t,platform:s,elements:i}=e,a=await(s.isRTL==null?void 0:s.isRTL(i.floating)),o=Ie(t),l=rt(t),c=we(t)==="y",d=Ds.has(o)?-1:1,f=a&&c?-1:1,u=Ee(r,e);let{mainAxis:g,crossAxis:w,alignmentAxis:b}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return l&&typeof b=="number"&&(w=l==="end"?b*-1:b),c?{x:w*f,y:g*d}:{x:g*d,y:w*f}}const uo=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var t,s;const{x:i,y:a,placement:o,middlewareData:l}=r,c=await co(r,e);return o===((t=l.offset)==null?void 0:t.placement)&&(s=l.arrow)!=null&&s.alignmentOffset?{}:{x:i+c.x,y:a+c.y,data:{...c,placement:o}}}}},mo=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:t,y:s,placement:i}=r,{mainAxis:a=!0,crossAxis:o=!1,limiter:l={fn:m=>{let{x:p,y:x}=m;return{x:p,y:x}}},...c}=Ee(e,r),d={x:t,y:s},f=await mt(r,c),u=we(Ie(i)),g=Nr(u);let w=d[g],b=d[u];if(a){const m=g==="y"?"top":"left",p=g==="y"?"bottom":"right",x=w+f[m],j=w-f[p];w=dr(x,w,j)}if(o){const m=u==="y"?"top":"left",p=u==="y"?"bottom":"right",x=b+f[m],j=b-f[p];b=dr(x,b,j)}const v=l.fn({...r,[g]:w,[u]:b});return{...v,data:{x:v.x-t,y:v.y-s,enabled:{[g]:a,[u]:o}}}}}},ho=function(e){return e===void 0&&(e={}),{options:e,fn(r){const{x:t,y:s,placement:i,rects:a,middlewareData:o}=r,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Ee(e,r),f={x:t,y:s},u=we(i),g=Nr(u);let w=f[g],b=f[u];const v=Ee(l,r),m=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const j=g==="y"?"height":"width",k=a.reference[g]-a.floating[j]+m.mainAxis,C=a.reference[g]+a.reference[j]-m.mainAxis;w<k?w=k:w>C&&(w=C)}if(d){var p,x;const j=g==="y"?"width":"height",k=Ds.has(Ie(i)),C=a.reference[u]-a.floating[j]+(k&&((p=o.offset)==null?void 0:p[u])||0)+(k?0:m.crossAxis),y=a.reference[u]+a.reference[j]+(k?0:((x=o.offset)==null?void 0:x[u])||0)-(k?m.crossAxis:0);b<C?b=C:b>y&&(b=y)}return{[g]:w,[u]:b}}}},fo=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(r){var t,s;const{placement:i,rects:a,platform:o,elements:l}=r,{apply:c=()=>{},...d}=Ee(e,r),f=await mt(r,d),u=Ie(i),g=rt(i),w=we(i)==="y",{width:b,height:v}=a.floating;let m,p;u==="top"||u==="bottom"?(m=u,p=g===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(p=u,m=g==="end"?"top":"bottom");const x=v-f.top-f.bottom,j=b-f.left-f.right,k=Me(v-f[m],x),C=Me(b-f[p],j),y=!r.middlewareData.shift;let N=k,_=C;if((t=r.middlewareData.shift)!=null&&t.enabled.x&&(_=j),(s=r.middlewareData.shift)!=null&&s.enabled.y&&(N=x),y&&!g){const E=me(f.left,0),L=me(f.right,0),O=me(f.top,0),$=me(f.bottom,0);w?_=b-2*(E!==0||L!==0?E+L:me(f.left,f.right)):N=v-2*(O!==0||$!==0?O+$:me(f.top,f.bottom))}await c({...r,availableWidth:_,availableHeight:N});const A=await o.getDimensions(l.floating);return b!==A.width||v!==A.height?{reset:{rects:!0}}:{}}}};function Dt(){return typeof window<"u"}function st(e){return Ms(e)?(e.nodeName||"").toLowerCase():"#document"}function he(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function Ne(e){var r;return(r=(Ms(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function Ms(e){return Dt()?e instanceof Node||e instanceof he(e).Node:!1}function xe(e){return Dt()?e instanceof Element||e instanceof he(e).Element:!1}function Se(e){return Dt()?e instanceof HTMLElement||e instanceof he(e).HTMLElement:!1}function os(e){return!Dt()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof he(e).ShadowRoot}const po=new Set(["inline","contents"]);function ft(e){const{overflow:r,overflowX:t,overflowY:s,display:i}=ye(e);return/auto|scroll|overlay|hidden|clip/.test(r+s+t)&&!po.has(i)}const go=new Set(["table","td","th"]);function xo(e){return go.has(st(e))}const yo=[":popover-open",":modal"];function Mt(e){return yo.some(r=>{try{return e.matches(r)}catch{return!1}})}const vo=["transform","translate","scale","rotate","perspective"],bo=["transform","translate","scale","rotate","perspective","filter"],wo=["paint","layout","strict","content"];function Rr(e){const r=Ar(),t=xe(e)?ye(e):e;return vo.some(s=>t[s]?t[s]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!r&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!r&&(t.filter?t.filter!=="none":!1)||bo.some(s=>(t.willChange||"").includes(s))||wo.some(s=>(t.contain||"").includes(s))}function ko(e){let r=Le(e);for(;Se(r)&&!et(r);){if(Rr(r))return r;if(Mt(r))return null;r=Le(r)}return null}function Ar(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const jo=new Set(["html","body","#document"]);function et(e){return jo.has(st(e))}function ye(e){return he(e).getComputedStyle(e)}function Lt(e){return xe(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Le(e){if(st(e)==="html")return e;const r=e.assignedSlot||e.parentNode||os(e)&&e.host||Ne(e);return os(r)?r.host:r}function Ls(e){const r=Le(e);return et(r)?e.ownerDocument?e.ownerDocument.body:e.body:Se(r)&&ft(r)?r:Ls(r)}function ht(e,r,t){var s;r===void 0&&(r=[]),t===void 0&&(t=!0);const i=Ls(e),a=i===((s=e.ownerDocument)==null?void 0:s.body),o=he(i);if(a){const l=mr(o);return r.concat(o,o.visualViewport||[],ft(i)?i:[],l&&t?ht(l):[])}return r.concat(i,ht(i,[],t))}function mr(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function zs(e){const r=ye(e);let t=parseFloat(r.width)||0,s=parseFloat(r.height)||0;const i=Se(e),a=i?e.offsetWidth:t,o=i?e.offsetHeight:s,l=Ct(t)!==a||Ct(s)!==o;return l&&(t=a,s=o),{width:t,height:s,$:l}}function Pr(e){return xe(e)?e:e.contextElement}function Xe(e){const r=Pr(e);if(!Se(r))return ke(1);const t=r.getBoundingClientRect(),{width:s,height:i,$:a}=zs(r);let o=(a?Ct(t.width):t.width)/s,l=(a?Ct(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const So=ke(0);function $s(e){const r=he(e);return!Ar()||!r.visualViewport?So:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function No(e,r,t){return r===void 0&&(r=!1),!t||r&&t!==he(e)?!1:r}function Ve(e,r,t,s){r===void 0&&(r=!1),t===void 0&&(t=!1);const i=e.getBoundingClientRect(),a=Pr(e);let o=ke(1);r&&(s?xe(s)&&(o=Xe(s)):o=Xe(e));const l=No(a,t,s)?$s(a):ke(0);let c=(i.left+l.x)/o.x,d=(i.top+l.y)/o.y,f=i.width/o.x,u=i.height/o.y;if(a){const g=he(a),w=s&&xe(s)?he(s):s;let b=g,v=mr(b);for(;v&&s&&w!==b;){const m=Xe(v),p=v.getBoundingClientRect(),x=ye(v),j=p.left+(v.clientLeft+parseFloat(x.paddingLeft))*m.x,k=p.top+(v.clientTop+parseFloat(x.paddingTop))*m.y;c*=m.x,d*=m.y,f*=m.x,u*=m.y,c+=j,d+=k,b=he(v),v=mr(b)}}return Rt({width:f,height:u,x:c,y:d})}function zt(e,r){const t=Lt(e).scrollLeft;return r?r.left+t:Ve(Ne(e)).left+t}function Fs(e,r){const t=e.getBoundingClientRect(),s=t.left+r.scrollLeft-zt(e,t),i=t.top+r.scrollTop;return{x:s,y:i}}function Co(e){let{elements:r,rect:t,offsetParent:s,strategy:i}=e;const a=i==="fixed",o=Ne(s),l=r?Mt(r.floating):!1;if(s===o||l&&a)return t;let c={scrollLeft:0,scrollTop:0},d=ke(1);const f=ke(0),u=Se(s);if((u||!u&&!a)&&((st(s)!=="body"||ft(o))&&(c=Lt(s)),Se(s))){const w=Ve(s);d=Xe(s),f.x=w.x+s.clientLeft,f.y=w.y+s.clientTop}const g=o&&!u&&!a?Fs(o,c):ke(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-c.scrollLeft*d.x+f.x+g.x,y:t.y*d.y-c.scrollTop*d.y+f.y+g.y}}function _o(e){return Array.from(e.getClientRects())}function Ro(e){const r=Ne(e),t=Lt(e),s=e.ownerDocument.body,i=me(r.scrollWidth,r.clientWidth,s.scrollWidth,s.clientWidth),a=me(r.scrollHeight,r.clientHeight,s.scrollHeight,s.clientHeight);let o=-t.scrollLeft+zt(e);const l=-t.scrollTop;return ye(s).direction==="rtl"&&(o+=me(r.clientWidth,s.clientWidth)-i),{width:i,height:a,x:o,y:l}}const ls=25;function Ao(e,r){const t=he(e),s=Ne(e),i=t.visualViewport;let a=s.clientWidth,o=s.clientHeight,l=0,c=0;if(i){a=i.width,o=i.height;const f=Ar();(!f||f&&r==="fixed")&&(l=i.offsetLeft,c=i.offsetTop)}const d=zt(s);if(d<=0){const f=s.ownerDocument,u=f.body,g=getComputedStyle(u),w=f.compatMode==="CSS1Compat"&&parseFloat(g.marginLeft)+parseFloat(g.marginRight)||0,b=Math.abs(s.clientWidth-u.clientWidth-w);b<=ls&&(a-=b)}else d<=ls&&(a+=d);return{width:a,height:o,x:l,y:c}}const Po=new Set(["absolute","fixed"]);function Eo(e,r){const t=Ve(e,!0,r==="fixed"),s=t.top+e.clientTop,i=t.left+e.clientLeft,a=Se(e)?Xe(e):ke(1),o=e.clientWidth*a.x,l=e.clientHeight*a.y,c=i*a.x,d=s*a.y;return{width:o,height:l,x:c,y:d}}function cs(e,r,t){let s;if(r==="viewport")s=Ao(e,t);else if(r==="document")s=Ro(Ne(e));else if(xe(r))s=Eo(r,t);else{const i=$s(e);s={x:r.x-i.x,y:r.y-i.y,width:r.width,height:r.height}}return Rt(s)}function Bs(e,r){const t=Le(e);return t===r||!xe(t)||et(t)?!1:ye(t).position==="fixed"||Bs(t,r)}function Io(e,r){const t=r.get(e);if(t)return t;let s=ht(e,[],!1).filter(l=>xe(l)&&st(l)!=="body"),i=null;const a=ye(e).position==="fixed";let o=a?Le(e):e;for(;xe(o)&&!et(o);){const l=ye(o),c=Rr(o);!c&&l.position==="fixed"&&(i=null),(a?!c&&!i:!c&&l.position==="static"&&!!i&&Po.has(i.position)||ft(o)&&!c&&Bs(e,o))?s=s.filter(f=>f!==o):i=l,o=Le(o)}return r.set(e,s),s}function Oo(e){let{element:r,boundary:t,rootBoundary:s,strategy:i}=e;const o=[...t==="clippingAncestors"?Mt(r)?[]:Io(r,this._c):[].concat(t),s],l=o[0],c=o.reduce((d,f)=>{const u=cs(r,f,i);return d.top=me(u.top,d.top),d.right=Me(u.right,d.right),d.bottom=Me(u.bottom,d.bottom),d.left=me(u.left,d.left),d},cs(r,l,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function To(e){const{width:r,height:t}=zs(e);return{width:r,height:t}}function Do(e,r,t){const s=Se(r),i=Ne(r),a=t==="fixed",o=Ve(e,!0,a,r);let l={scrollLeft:0,scrollTop:0};const c=ke(0);function d(){c.x=zt(i)}if(s||!s&&!a)if((st(r)!=="body"||ft(i))&&(l=Lt(r)),s){const w=Ve(r,!0,a,r);c.x=w.x+r.clientLeft,c.y=w.y+r.clientTop}else i&&d();a&&!s&&i&&d();const f=i&&!s&&!a?Fs(i,l):ke(0),u=o.left+l.scrollLeft-c.x-f.x,g=o.top+l.scrollTop-c.y-f.y;return{x:u,y:g,width:o.width,height:o.height}}function Jt(e){return ye(e).position==="static"}function ds(e,r){if(!Se(e)||ye(e).position==="fixed")return null;if(r)return r(e);let t=e.offsetParent;return Ne(e)===t&&(t=t.ownerDocument.body),t}function Vs(e,r){const t=he(e);if(Mt(e))return t;if(!Se(e)){let i=Le(e);for(;i&&!et(i);){if(xe(i)&&!Jt(i))return i;i=Le(i)}return t}let s=ds(e,r);for(;s&&xo(s)&&Jt(s);)s=ds(s,r);return s&&et(s)&&Jt(s)&&!Rr(s)?t:s||ko(e)||t}const Mo=async function(e){const r=this.getOffsetParent||Vs,t=this.getDimensions,s=await t(e.floating);return{reference:Do(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Lo(e){return ye(e).direction==="rtl"}const zo={convertOffsetParentRelativeRectToViewportRelativeRect:Co,getDocumentElement:Ne,getClippingRect:Oo,getOffsetParent:Vs,getElementRects:Mo,getClientRects:_o,getDimensions:To,getScale:Xe,isElement:xe,isRTL:Lo};function Ws(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function $o(e,r){let t=null,s;const i=Ne(e);function a(){var l;clearTimeout(s),(l=t)==null||l.disconnect(),t=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const d=e.getBoundingClientRect(),{left:f,top:u,width:g,height:w}=d;if(l||r(),!g||!w)return;const b=yt(u),v=yt(i.clientWidth-(f+g)),m=yt(i.clientHeight-(u+w)),p=yt(f),j={rootMargin:-b+"px "+-v+"px "+-m+"px "+-p+"px",threshold:me(0,Me(1,c))||1};let k=!0;function C(y){const N=y[0].intersectionRatio;if(N!==c){if(!k)return o();N?o(!1,N):s=setTimeout(()=>{o(!1,1e-7)},1e3)}N===1&&!Ws(d,e.getBoundingClientRect())&&o(),k=!1}try{t=new IntersectionObserver(C,{...j,root:i.ownerDocument})}catch{t=new IntersectionObserver(C,j)}t.observe(e)}return o(!0),a}function Fo(e,r,t,s){s===void 0&&(s={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=s,d=Pr(e),f=i||a?[...d?ht(d):[],...ht(r)]:[];f.forEach(p=>{i&&p.addEventListener("scroll",t,{passive:!0}),a&&p.addEventListener("resize",t)});const u=d&&l?$o(d,t):null;let g=-1,w=null;o&&(w=new ResizeObserver(p=>{let[x]=p;x&&x.target===d&&w&&(w.unobserve(r),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var j;(j=w)==null||j.observe(r)})),t()}),d&&!c&&w.observe(d),w.observe(r));let b,v=c?Ve(e):null;c&&m();function m(){const p=Ve(e);v&&!Ws(v,p)&&t(),v=p,b=requestAnimationFrame(m)}return t(),()=>{var p;f.forEach(x=>{i&&x.removeEventListener("scroll",t),a&&x.removeEventListener("resize",t)}),u?.(),(p=w)==null||p.disconnect(),w=null,c&&cancelAnimationFrame(b)}}const Bo=uo,Vo=mo,Wo=oo,Ho=fo,Uo=lo,us=ao,Ko=ho,Go=(e,r,t)=>{const s=new Map,i={platform:zo,...t},a={...i.platform,_c:s};return io(e,r,{...i,platform:a})};var qo=typeof document<"u",Yo=function(){},bt=qo?h.useLayoutEffect:Yo;function At(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let t,s,i;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==r.length)return!1;for(s=t;s--!==0;)if(!At(e[s],r[s]))return!1;return!0}if(i=Object.keys(e),t=i.length,t!==Object.keys(r).length)return!1;for(s=t;s--!==0;)if(!{}.hasOwnProperty.call(r,i[s]))return!1;for(s=t;s--!==0;){const a=i[s];if(!(a==="_owner"&&e.$$typeof)&&!At(e[a],r[a]))return!1}return!0}return e!==e&&r!==r}function Hs(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ms(e,r){const t=Hs(e);return Math.round(r*t)/t}function Qt(e){const r=h.useRef(e);return bt(()=>{r.current=e}),r}function Xo(e){e===void 0&&(e={});const{placement:r="bottom",strategy:t="absolute",middleware:s=[],platform:i,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[f,u]=h.useState({x:0,y:0,strategy:t,placement:r,middlewareData:{},isPositioned:!1}),[g,w]=h.useState(s);At(g,s)||w(s);const[b,v]=h.useState(null),[m,p]=h.useState(null),x=h.useCallback(R=>{R!==y.current&&(y.current=R,v(R))},[]),j=h.useCallback(R=>{R!==N.current&&(N.current=R,p(R))},[]),k=a||b,C=o||m,y=h.useRef(null),N=h.useRef(null),_=h.useRef(f),A=c!=null,E=Qt(c),L=Qt(i),O=Qt(d),$=h.useCallback(()=>{if(!y.current||!N.current)return;const R={placement:r,strategy:t,middleware:g};L.current&&(R.platform=L.current),Go(y.current,N.current,R).then(D=>{const H={...D,isPositioned:O.current!==!1};T.current&&!At(_.current,H)&&(_.current=H,Ot.flushSync(()=>{u(H)}))})},[g,r,t,L,O]);bt(()=>{d===!1&&_.current.isPositioned&&(_.current.isPositioned=!1,u(R=>({...R,isPositioned:!1})))},[d]);const T=h.useRef(!1);bt(()=>(T.current=!0,()=>{T.current=!1}),[]),bt(()=>{if(k&&(y.current=k),C&&(N.current=C),k&&C){if(E.current)return E.current(k,C,$);$()}},[k,C,$,E,A]);const V=h.useMemo(()=>({reference:y,floating:N,setReference:x,setFloating:j}),[x,j]),z=h.useMemo(()=>({reference:k,floating:C}),[k,C]),B=h.useMemo(()=>{const R={position:t,left:0,top:0};if(!z.floating)return R;const D=ms(z.floating,f.x),H=ms(z.floating,f.y);return l?{...R,transform:"translate("+D+"px, "+H+"px)",...Hs(z.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:D,top:H}},[t,l,z.floating,f.x,f.y]);return h.useMemo(()=>({...f,update:$,refs:V,elements:z,floatingStyles:B}),[f,$,V,z,B])}const Zo=e=>{function r(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:s,padding:i}=typeof e=="function"?e(t):e;return s&&r(s)?s.current!=null?us({element:s.current,padding:i}).fn(t):{}:s?us({element:s,padding:i}).fn(t):{}}}},Jo=(e,r)=>({...Bo(e),options:[e,r]}),Qo=(e,r)=>({...Vo(e),options:[e,r]}),el=(e,r)=>({...Ko(e),options:[e,r]}),tl=(e,r)=>({...Wo(e),options:[e,r]}),rl=(e,r)=>({...Ho(e),options:[e,r]}),sl=(e,r)=>({...Uo(e),options:[e,r]}),nl=(e,r)=>({...Zo(e),options:[e,r]});var il="Arrow",Us=h.forwardRef((e,r)=>{const{children:t,width:s=10,height:i=5,...a}=e;return n.jsx(oe.svg,{...a,ref:r,width:s,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?t:n.jsx("polygon",{points:"0,0 30,0 15,10"})})});Us.displayName=il;var al=Us,Er="Popper",[Ks,Gs]=vs(Er),[ol,qs]=Ks(Er),Ys=e=>{const{__scopePopper:r,children:t}=e,[s,i]=h.useState(null);return n.jsx(ol,{scope:r,anchor:s,onAnchorChange:i,children:t})};Ys.displayName=Er;var Xs="PopperAnchor",Zs=h.forwardRef((e,r)=>{const{__scopePopper:t,virtualRef:s,...i}=e,a=qs(Xs,t),o=h.useRef(null),l=pe(r,o),c=h.useRef(null);return h.useEffect(()=>{const d=c.current;c.current=s?.current||o.current,d!==c.current&&a.onAnchorChange(c.current)}),s?null:n.jsx(oe.div,{...i,ref:l})});Zs.displayName=Xs;var Ir="PopperContent",[ll,cl]=Ks(Ir),Js=h.forwardRef((e,r)=>{const{__scopePopper:t,side:s="bottom",sideOffset:i=0,align:a="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:f=0,sticky:u="partial",hideWhenDetached:g=!1,updatePositionStrategy:w="optimized",onPlaced:b,...v}=e,m=qs(Ir,t),[p,x]=h.useState(null),j=pe(r,M=>x(M)),[k,C]=h.useState(null),y=ri(k),N=y?.width??0,_=y?.height??0,A=s+(a!=="center"?"-"+a:""),E=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},L=Array.isArray(d)?d:[d],O=L.length>0,$={padding:E,boundary:L.filter(ul),altBoundary:O},{refs:T,floatingStyles:V,placement:z,isPositioned:B,middlewareData:R}=Xo({strategy:"fixed",placement:A,whileElementsMounted:(...M)=>Fo(...M,{animationFrame:w==="always"}),elements:{reference:m.anchor},middleware:[Jo({mainAxis:i+_,alignmentAxis:o}),c&&Qo({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?el():void 0,...$}),c&&tl({...$}),rl({...$,apply:({elements:M,rects:q,availableWidth:ne,availableHeight:K})=>{const{width:U,height:Y}=q.reference,ie=M.floating.style;ie.setProperty("--radix-popper-available-width",`${ne}px`),ie.setProperty("--radix-popper-available-height",`${K}px`),ie.setProperty("--radix-popper-anchor-width",`${U}px`),ie.setProperty("--radix-popper-anchor-height",`${Y}px`)}}),k&&nl({element:k,padding:l}),ml({arrowWidth:N,arrowHeight:_}),g&&sl({strategy:"referenceHidden",...$})]}),[D,H]=tn(z),se=bs(b);je(()=>{B&&se?.()},[B,se]);const G=R.arrow?.x,ee=R.arrow?.y,te=R.arrow?.centerOffset!==0,[X,le]=h.useState();return je(()=>{p&&le(window.getComputedStyle(p).zIndex)},[p]),n.jsx("div",{ref:T.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:B?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[R.transformOrigin?.x,R.transformOrigin?.y].join(" "),...R.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:n.jsx(ll,{scope:t,placedSide:D,onArrowChange:C,arrowX:G,arrowY:ee,shouldHideArrow:te,children:n.jsx(oe.div,{"data-side":D,"data-align":H,...v,ref:j,style:{...v.style,animation:B?void 0:"none"}})})})});Js.displayName=Ir;var Qs="PopperArrow",dl={top:"bottom",right:"left",bottom:"top",left:"right"},en=h.forwardRef(function(r,t){const{__scopePopper:s,...i}=r,a=cl(Qs,s),o=dl[a.placedSide];return n.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:n.jsx(al,{...i,ref:t,style:{...i.style,display:"block"}})})});en.displayName=Qs;function ul(e){return e!==null}var ml=e=>({name:"transformOrigin",options:e,fn(r){const{placement:t,rects:s,middlewareData:i}=r,o=i.arrow?.centerOffset!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[d,f]=tn(t),u={start:"0%",center:"50%",end:"100%"}[f],g=(i.arrow?.x??0)+l/2,w=(i.arrow?.y??0)+c/2;let b="",v="";return d==="bottom"?(b=o?u:`${g}px`,v=`${-c}px`):d==="top"?(b=o?u:`${g}px`,v=`${s.floating.height+c}px`):d==="right"?(b=`${-c}px`,v=o?u:`${w}px`):d==="left"&&(b=`${s.floating.width+c}px`,v=o?u:`${w}px`),{data:{x:b,y:v}}}});function tn(e){const[r,t="center"]=e.split("-");return[r,t]}var hl=Ys,fl=Zs,pl=Js,gl=en;function xl(e){const r=yl(e),t=h.forwardRef((s,i)=>{const{children:a,...o}=s,l=h.Children.toArray(a),c=l.find(bl);if(c){const d=c.props.children,f=l.map(u=>u===c?h.Children.count(d)>1?h.Children.only(null):h.isValidElement(d)?d.props.children:null:u);return n.jsx(r,{...o,ref:i,children:h.isValidElement(d)?h.cloneElement(d,void 0,f):null})}return n.jsx(r,{...o,ref:i,children:a})});return t.displayName=`${e}.Slot`,t}function yl(e){const r=h.forwardRef((t,s)=>{const{children:i,...a}=t;if(h.isValidElement(i)){const o=kl(i),l=wl(a,i.props);return i.type!==h.Fragment&&(l.ref=s?si(s,o):o),h.cloneElement(i,l)}return h.Children.count(i)>1?h.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var vl=Symbol("radix.slottable");function bl(e){return h.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===vl}function wl(e,r){const t={...r};for(const s in r){const i=e[s],a=r[s];/^on[A-Z]/.test(s)?i&&a?t[s]=(...l)=>{const c=a(...l);return i(...l),c}:i&&(t[s]=i):s==="style"?t[s]={...i,...a}:s==="className"&&(t[s]=[i,a].filter(Boolean).join(" "))}return{...e,...t}}function kl(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var jl=[" ","Enter","ArrowUp","ArrowDown"],Sl=[" ","Enter"],We="Select",[$t,Ft,Nl]=ni(We),[nt]=vs(We,[Nl,Gs]),Bt=Gs(),[Cl,$e]=nt(We),[_l,Rl]=nt(We),rn=e=>{const{__scopeSelect:r,children:t,open:s,defaultOpen:i,onOpenChange:a,value:o,defaultValue:l,onValueChange:c,dir:d,name:f,autoComplete:u,disabled:g,required:w,form:b}=e,v=Bt(r),[m,p]=h.useState(null),[x,j]=h.useState(null),[k,C]=h.useState(!1),y=Ga(d),[N,_]=zr({prop:s,defaultProp:i??!1,onChange:a,caller:We}),[A,E]=zr({prop:o,defaultProp:l,onChange:c,caller:We}),L=h.useRef(null),O=m?b||!!m.closest("form"):!0,[$,T]=h.useState(new Set),V=Array.from($).map(z=>z.props.value).join(";");return n.jsx(hl,{...v,children:n.jsxs(Cl,{required:w,scope:r,trigger:m,onTriggerChange:p,valueNode:x,onValueNodeChange:j,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:br(),value:A,onValueChange:E,open:N,onOpenChange:_,dir:y,triggerPointerDownPosRef:L,disabled:g,children:[n.jsx($t.Provider,{scope:r,children:n.jsx(_l,{scope:e.__scopeSelect,onNativeOptionAdd:h.useCallback(z=>{T(B=>new Set(B).add(z))},[]),onNativeOptionRemove:h.useCallback(z=>{T(B=>{const R=new Set(B);return R.delete(z),R})},[]),children:t})}),O?n.jsxs(_n,{"aria-hidden":!0,required:w,tabIndex:-1,name:f,autoComplete:u,value:A,onChange:z=>E(z.target.value),disabled:g,form:b,children:[A===void 0?n.jsx("option",{value:""}):null,Array.from($)]},V):null]})})};rn.displayName=We;var sn="SelectTrigger",nn=h.forwardRef((e,r)=>{const{__scopeSelect:t,disabled:s=!1,...i}=e,a=Bt(t),o=$e(sn,t),l=o.disabled||s,c=pe(r,o.onTriggerChange),d=Ft(t),f=h.useRef("touch"),[u,g,w]=An(v=>{const m=d().filter(j=>!j.disabled),p=m.find(j=>j.value===o.value),x=Pn(m,v,p);x!==void 0&&o.onValueChange(x.value)}),b=v=>{l||(o.onOpenChange(!0),w()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return n.jsx(fl,{asChild:!0,...a,children:n.jsx(oe.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Rn(o.value)?"":void 0,...i,ref:c,onClick:ae(i.onClick,v=>{v.currentTarget.focus(),f.current!=="mouse"&&b(v)}),onPointerDown:ae(i.onPointerDown,v=>{f.current=v.pointerType;const m=v.target;m.hasPointerCapture(v.pointerId)&&m.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(b(v),v.preventDefault())}),onKeyDown:ae(i.onKeyDown,v=>{const m=u.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&g(v.key),!(m&&v.key===" ")&&jl.includes(v.key)&&(b(),v.preventDefault())})})})});nn.displayName=sn;var an="SelectValue",on=h.forwardRef((e,r)=>{const{__scopeSelect:t,className:s,style:i,children:a,placeholder:o="",...l}=e,c=$e(an,t),{onValueNodeHasChildrenChange:d}=c,f=a!==void 0,u=pe(r,c.onValueNodeChange);return je(()=>{d(f)},[d,f]),n.jsx(oe.span,{...l,ref:u,style:{pointerEvents:"none"},children:Rn(c.value)?n.jsx(n.Fragment,{children:o}):a})});on.displayName=an;var Al="SelectIcon",ln=h.forwardRef((e,r)=>{const{__scopeSelect:t,children:s,...i}=e;return n.jsx(oe.span,{"aria-hidden":!0,...i,ref:r,children:s||"▼"})});ln.displayName=Al;var Pl="SelectPortal",cn=e=>n.jsx(oi,{asChild:!0,...e});cn.displayName=Pl;var He="SelectContent",dn=h.forwardRef((e,r)=>{const t=$e(He,e.__scopeSelect),[s,i]=h.useState();if(je(()=>{i(new DocumentFragment)},[]),!t.open){const a=s;return a?Ot.createPortal(n.jsx(un,{scope:e.__scopeSelect,children:n.jsx($t.Slot,{scope:e.__scopeSelect,children:n.jsx("div",{children:e.children})})}),a):null}return n.jsx(mn,{...e,ref:r})});dn.displayName=He;var ge=10,[un,Fe]=nt(He),El="SelectContentImpl",Il=xl("SelectContent.RemoveScroll"),mn=h.forwardRef((e,r)=>{const{__scopeSelect:t,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:a,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:f,arrowPadding:u,collisionBoundary:g,collisionPadding:w,sticky:b,hideWhenDetached:v,avoidCollisions:m,...p}=e,x=$e(He,t),[j,k]=h.useState(null),[C,y]=h.useState(null),N=pe(r,M=>k(M)),[_,A]=h.useState(null),[E,L]=h.useState(null),O=Ft(t),[$,T]=h.useState(!1),V=h.useRef(!1);h.useEffect(()=>{if(j)return li(j)},[j]),ci();const z=h.useCallback(M=>{const[q,...ne]=O().map(Y=>Y.ref.current),[K]=ne.slice(-1),U=document.activeElement;for(const Y of M)if(Y===U||(Y?.scrollIntoView({block:"nearest"}),Y===q&&C&&(C.scrollTop=0),Y===K&&C&&(C.scrollTop=C.scrollHeight),Y?.focus(),document.activeElement!==U))return},[O,C]),B=h.useCallback(()=>z([_,j]),[z,_,j]);h.useEffect(()=>{$&&B()},[$,B]);const{onOpenChange:R,triggerPointerDownPosRef:D}=x;h.useEffect(()=>{if(j){let M={x:0,y:0};const q=K=>{M={x:Math.abs(Math.round(K.pageX)-(D.current?.x??0)),y:Math.abs(Math.round(K.pageY)-(D.current?.y??0))}},ne=K=>{M.x<=10&&M.y<=10?K.preventDefault():j.contains(K.target)||R(!1),document.removeEventListener("pointermove",q),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",q),document.addEventListener("pointerup",ne,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",q),document.removeEventListener("pointerup",ne,{capture:!0})}}},[j,R,D]),h.useEffect(()=>{const M=()=>R(!1);return window.addEventListener("blur",M),window.addEventListener("resize",M),()=>{window.removeEventListener("blur",M),window.removeEventListener("resize",M)}},[R]);const[H,se]=An(M=>{const q=O().filter(U=>!U.disabled),ne=q.find(U=>U.ref.current===document.activeElement),K=Pn(q,M,ne);K&&setTimeout(()=>K.ref.current.focus())}),G=h.useCallback((M,q,ne)=>{const K=!V.current&&!ne;(x.value!==void 0&&x.value===q||K)&&(A(M),K&&(V.current=!0))},[x.value]),ee=h.useCallback(()=>j?.focus(),[j]),te=h.useCallback((M,q,ne)=>{const K=!V.current&&!ne;(x.value!==void 0&&x.value===q||K)&&L(M)},[x.value]),X=s==="popper"?hr:hn,le=X===hr?{side:l,sideOffset:c,align:d,alignOffset:f,arrowPadding:u,collisionBoundary:g,collisionPadding:w,sticky:b,hideWhenDetached:v,avoidCollisions:m}:{};return n.jsx(un,{scope:t,content:j,viewport:C,onViewportChange:y,itemRefCallback:G,selectedItem:_,onItemLeave:ee,itemTextRefCallback:te,focusSelectedItem:B,selectedItemText:E,position:s,isPositioned:$,searchRef:H,children:n.jsx(di,{as:Il,allowPinchZoom:!0,children:n.jsx(ui,{asChild:!0,trapped:x.open,onMountAutoFocus:M=>{M.preventDefault()},onUnmountAutoFocus:ae(i,M=>{x.trigger?.focus({preventScroll:!0}),M.preventDefault()}),children:n.jsx(mi,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:M=>M.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:n.jsx(X,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:M=>M.preventDefault(),...p,...le,onPlaced:()=>T(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...p.style},onKeyDown:ae(p.onKeyDown,M=>{const q=M.ctrlKey||M.altKey||M.metaKey;if(M.key==="Tab"&&M.preventDefault(),!q&&M.key.length===1&&se(M.key),["ArrowUp","ArrowDown","Home","End"].includes(M.key)){let K=O().filter(U=>!U.disabled).map(U=>U.ref.current);if(["ArrowUp","End"].includes(M.key)&&(K=K.slice().reverse()),["ArrowUp","ArrowDown"].includes(M.key)){const U=M.target,Y=K.indexOf(U);K=K.slice(Y+1)}setTimeout(()=>z(K)),M.preventDefault()}})})})})})})});mn.displayName=El;var Ol="SelectItemAlignedPosition",hn=h.forwardRef((e,r)=>{const{__scopeSelect:t,onPlaced:s,...i}=e,a=$e(He,t),o=Fe(He,t),[l,c]=h.useState(null),[d,f]=h.useState(null),u=pe(r,N=>f(N)),g=Ft(t),w=h.useRef(!1),b=h.useRef(!0),{viewport:v,selectedItem:m,selectedItemText:p,focusSelectedItem:x}=o,j=h.useCallback(()=>{if(a.trigger&&a.valueNode&&l&&d&&v&&m&&p){const N=a.trigger.getBoundingClientRect(),_=d.getBoundingClientRect(),A=a.valueNode.getBoundingClientRect(),E=p.getBoundingClientRect();if(a.dir!=="rtl"){const U=E.left-_.left,Y=A.left-U,ie=N.left-Y,re=N.width+ie,Ce=Math.max(re,_.width),Ue=window.innerWidth-ge,Ke=ts(Y,[ge,Math.max(ge,Ue-Ce)]);l.style.minWidth=re+"px",l.style.left=Ke+"px"}else{const U=_.right-E.right,Y=window.innerWidth-A.right-U,ie=window.innerWidth-N.right-Y,re=N.width+ie,Ce=Math.max(re,_.width),Ue=window.innerWidth-ge,Ke=ts(Y,[ge,Math.max(ge,Ue-Ce)]);l.style.minWidth=re+"px",l.style.right=Ke+"px"}const L=g(),O=window.innerHeight-ge*2,$=v.scrollHeight,T=window.getComputedStyle(d),V=parseInt(T.borderTopWidth,10),z=parseInt(T.paddingTop,10),B=parseInt(T.borderBottomWidth,10),R=parseInt(T.paddingBottom,10),D=V+z+$+R+B,H=Math.min(m.offsetHeight*5,D),se=window.getComputedStyle(v),G=parseInt(se.paddingTop,10),ee=parseInt(se.paddingBottom,10),te=N.top+N.height/2-ge,X=O-te,le=m.offsetHeight/2,M=m.offsetTop+le,q=V+z+M,ne=D-q;if(q<=te){const U=L.length>0&&m===L[L.length-1].ref.current;l.style.bottom="0px";const Y=d.clientHeight-v.offsetTop-v.offsetHeight,ie=Math.max(X,le+(U?ee:0)+Y+B),re=q+ie;l.style.height=re+"px"}else{const U=L.length>0&&m===L[0].ref.current;l.style.top="0px";const ie=Math.max(te,V+v.offsetTop+(U?G:0)+le)+ne;l.style.height=ie+"px",v.scrollTop=q-te+v.offsetTop}l.style.margin=`${ge}px 0`,l.style.minHeight=H+"px",l.style.maxHeight=O+"px",s?.(),requestAnimationFrame(()=>w.current=!0)}},[g,a.trigger,a.valueNode,l,d,v,m,p,a.dir,s]);je(()=>j(),[j]);const[k,C]=h.useState();je(()=>{d&&C(window.getComputedStyle(d).zIndex)},[d]);const y=h.useCallback(N=>{N&&b.current===!0&&(j(),x?.(),b.current=!1)},[j,x]);return n.jsx(Dl,{scope:t,contentWrapper:l,shouldExpandOnScrollRef:w,onScrollButtonChange:y,children:n.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:n.jsx(oe.div,{...i,ref:u,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});hn.displayName=Ol;var Tl="SelectPopperPosition",hr=h.forwardRef((e,r)=>{const{__scopeSelect:t,align:s="start",collisionPadding:i=ge,...a}=e,o=Bt(t);return n.jsx(pl,{...o,...a,ref:r,align:s,collisionPadding:i,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});hr.displayName=Tl;var[Dl,Or]=nt(He,{}),fr="SelectViewport",fn=h.forwardRef((e,r)=>{const{__scopeSelect:t,nonce:s,...i}=e,a=Fe(fr,t),o=Or(fr,t),l=pe(r,a.onViewportChange),c=h.useRef(0);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),n.jsx($t.Slot,{scope:t,children:n.jsx(oe.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:ae(i.onScroll,d=>{const f=d.currentTarget,{contentWrapper:u,shouldExpandOnScrollRef:g}=o;if(g?.current&&u){const w=Math.abs(c.current-f.scrollTop);if(w>0){const b=window.innerHeight-ge*2,v=parseFloat(u.style.minHeight),m=parseFloat(u.style.height),p=Math.max(v,m);if(p<b){const x=p+w,j=Math.min(b,x),k=x-j;u.style.height=j+"px",u.style.bottom==="0px"&&(f.scrollTop=k>0?k:0,u.style.justifyContent="flex-end")}}}c.current=f.scrollTop})})})]})});fn.displayName=fr;var pn="SelectGroup",[Ml,Ll]=nt(pn),zl=h.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e,i=br();return n.jsx(Ml,{scope:t,id:i,children:n.jsx(oe.div,{role:"group","aria-labelledby":i,...s,ref:r})})});zl.displayName=pn;var gn="SelectLabel",xn=h.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e,i=Ll(gn,t);return n.jsx(oe.div,{id:i.id,...s,ref:r})});xn.displayName=gn;var Pt="SelectItem",[$l,yn]=nt(Pt),vn=h.forwardRef((e,r)=>{const{__scopeSelect:t,value:s,disabled:i=!1,textValue:a,...o}=e,l=$e(Pt,t),c=Fe(Pt,t),d=l.value===s,[f,u]=h.useState(a??""),[g,w]=h.useState(!1),b=pe(r,x=>c.itemRefCallback?.(x,s,i)),v=br(),m=h.useRef("touch"),p=()=>{i||(l.onValueChange(s),l.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return n.jsx($l,{scope:t,value:s,disabled:i,textId:v,isSelected:d,onItemTextChange:h.useCallback(x=>{u(j=>j||(x?.textContent??"").trim())},[]),children:n.jsx($t.ItemSlot,{scope:t,value:s,disabled:i,textValue:f,children:n.jsx(oe.div,{role:"option","aria-labelledby":v,"data-highlighted":g?"":void 0,"aria-selected":d&&g,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:b,onFocus:ae(o.onFocus,()=>w(!0)),onBlur:ae(o.onBlur,()=>w(!1)),onClick:ae(o.onClick,()=>{m.current!=="mouse"&&p()}),onPointerUp:ae(o.onPointerUp,()=>{m.current==="mouse"&&p()}),onPointerDown:ae(o.onPointerDown,x=>{m.current=x.pointerType}),onPointerMove:ae(o.onPointerMove,x=>{m.current=x.pointerType,i?c.onItemLeave?.():m.current==="mouse"&&x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ae(o.onPointerLeave,x=>{x.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:ae(o.onKeyDown,x=>{c.searchRef?.current!==""&&x.key===" "||(Sl.includes(x.key)&&p(),x.key===" "&&x.preventDefault())})})})})});vn.displayName=Pt;var lt="SelectItemText",bn=h.forwardRef((e,r)=>{const{__scopeSelect:t,className:s,style:i,...a}=e,o=$e(lt,t),l=Fe(lt,t),c=yn(lt,t),d=Rl(lt,t),[f,u]=h.useState(null),g=pe(r,p=>u(p),c.onItemTextChange,p=>l.itemTextRefCallback?.(p,c.value,c.disabled)),w=f?.textContent,b=h.useMemo(()=>n.jsx("option",{value:c.value,disabled:c.disabled,children:w},c.value),[c.disabled,c.value,w]),{onNativeOptionAdd:v,onNativeOptionRemove:m}=d;return je(()=>(v(b),()=>m(b)),[v,m,b]),n.jsxs(n.Fragment,{children:[n.jsx(oe.span,{id:c.textId,...a,ref:g}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ot.createPortal(a.children,o.valueNode):null]})});bn.displayName=lt;var wn="SelectItemIndicator",kn=h.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e;return yn(wn,t).isSelected?n.jsx(oe.span,{"aria-hidden":!0,...s,ref:r}):null});kn.displayName=wn;var pr="SelectScrollUpButton",jn=h.forwardRef((e,r)=>{const t=Fe(pr,e.__scopeSelect),s=Or(pr,e.__scopeSelect),[i,a]=h.useState(!1),o=pe(r,s.onScrollButtonChange);return je(()=>{if(t.viewport&&t.isPositioned){let l=function(){const d=c.scrollTop>0;a(d)};const c=t.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),i?n.jsx(Nn,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=t;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});jn.displayName=pr;var gr="SelectScrollDownButton",Sn=h.forwardRef((e,r)=>{const t=Fe(gr,e.__scopeSelect),s=Or(gr,e.__scopeSelect),[i,a]=h.useState(!1),o=pe(r,s.onScrollButtonChange);return je(()=>{if(t.viewport&&t.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<d;a(f)};const c=t.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),i?n.jsx(Nn,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=t;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});Sn.displayName=gr;var Nn=h.forwardRef((e,r)=>{const{__scopeSelect:t,onAutoScroll:s,...i}=e,a=Fe("SelectScrollButton",t),o=h.useRef(null),l=Ft(t),c=h.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return h.useEffect(()=>()=>c(),[c]),je(()=>{l().find(f=>f.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),n.jsx(oe.div,{"aria-hidden":!0,...i,ref:r,style:{flexShrink:0,...i.style},onPointerDown:ae(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:ae(i.onPointerMove,()=>{a.onItemLeave?.(),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:ae(i.onPointerLeave,()=>{c()})})}),Fl="SelectSeparator",Cn=h.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e;return n.jsx(oe.div,{"aria-hidden":!0,...s,ref:r})});Cn.displayName=Fl;var xr="SelectArrow",Bl=h.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e,i=Bt(t),a=$e(xr,t),o=Fe(xr,t);return a.open&&o.position==="popper"?n.jsx(gl,{...i,...s,ref:r}):null});Bl.displayName=xr;var Vl="SelectBubbleInput",_n=h.forwardRef(({__scopeSelect:e,value:r,...t},s)=>{const i=h.useRef(null),a=pe(s,i),o=ii(r);return h.useEffect(()=>{const l=i.current;if(!l)return;const c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==r&&f){const u=new Event("change",{bubbles:!0});f.call(l,r),l.dispatchEvent(u)}},[o,r]),n.jsx(oe.select,{...t,style:{...ai,...t.style},ref:a,defaultValue:r})});_n.displayName=Vl;function Rn(e){return e===""||e===void 0}function An(e){const r=bs(e),t=h.useRef(""),s=h.useRef(0),i=h.useCallback(o=>{const l=t.current+o;r(l),function c(d){t.current=d,window.clearTimeout(s.current),d!==""&&(s.current=window.setTimeout(()=>c(""),1e3))}(l)},[r]),a=h.useCallback(()=>{t.current="",window.clearTimeout(s.current)},[]);return h.useEffect(()=>()=>window.clearTimeout(s.current),[]),[t,i,a]}function Pn(e,r,t){const i=r.length>1&&Array.from(r).every(d=>d===r[0])?r[0]:r,a=t?e.indexOf(t):-1;let o=Wl(e,Math.max(a,0));i.length===1&&(o=o.filter(d=>d!==t));const c=o.find(d=>d.textValue.toLowerCase().startsWith(i.toLowerCase()));return c!==t?c:void 0}function Wl(e,r){return e.map((t,s)=>e[(r+s)%e.length])}var Hl=rn,En=nn,Ul=on,Kl=ln,Gl=cn,In=dn,ql=fn,On=xn,Tn=vn,Yl=bn,Xl=kn,Dn=jn,Mn=Sn,Ln=Cn;const Re=Hl,Ae=Ul,ve=h.forwardRef(({className:e,children:r,...t},s)=>n.jsxs(En,{ref:s,className:W("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[r,n.jsx(Kl,{asChild:!0,children:n.jsx(ut,{className:"h-4 w-4 opacity-50"})})]}));ve.displayName=En.displayName;const zn=h.forwardRef(({className:e,...r},t)=>n.jsx(Dn,{ref:t,className:W("flex cursor-default items-center justify-center py-1",e),...r,children:n.jsx(jt,{className:"h-4 w-4"})}));zn.displayName=Dn.displayName;const $n=h.forwardRef(({className:e,...r},t)=>n.jsx(Mn,{ref:t,className:W("flex cursor-default items-center justify-center py-1",e),...r,children:n.jsx(ut,{className:"h-4 w-4"})}));$n.displayName=Mn.displayName;const be=h.forwardRef(({className:e,children:r,position:t="popper",...s},i)=>n.jsx(Gl,{children:n.jsxs(In,{ref:i,className:W("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[n.jsx(zn,{}),n.jsx(ql,{className:W("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),n.jsx($n,{})]})}));be.displayName=In.displayName;const Zl=h.forwardRef(({className:e,...r},t)=>n.jsx(On,{ref:t,className:W("px-2 py-1.5 text-sm font-semibold",e),...r}));Zl.displayName=On.displayName;const Z=h.forwardRef(({className:e,children:r,...t},s)=>n.jsxs(Tn,{ref:s,className:W("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[n.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(Xl,{children:n.jsx(Ri,{className:"h-4 w-4"})})}),n.jsx(Yl,{children:r})]}));Z.displayName=Tn.displayName;const Jl=h.forwardRef(({className:e,...r},t)=>n.jsx(Ln,{ref:t,className:W("-mx-1 my-1 h-px bg-muted",e),...r}));Jl.displayName=Ln.displayName;const Ql={[Pe.High]:"#ef4444",[Pe.Medium]:"#f59e0b",[Pe.Low]:"#10b981"},ec=["All"],er=80,tc=6,hs=140,yr=140;function rc(e){if(e.length<=yr)return e;const r={[Pe.High]:3,[Pe.Medium]:2,[Pe.Low]:1},t=e.map(s=>{const i=s.riskLevel||Pe.Low,a=typeof s.churnProbability=="number"?s.churnProbability:0,l=((s.status||"").toLowerCase()!=="active"?4:0)+(r[i]||0)+a;return{employee:s,score:l}});return t.sort((s,i)=>i.score-s.score),t.slice(0,yr).map(s=>s.employee)}function fs(e,r){let t=0;const s=[];e.structure_name&&r.structure_name&&e.structure_name===r.structure_name&&(t+=.35,s.push("Department"));const i=(e.position||"").toLowerCase(),a=(r.position||"").toLowerCase();if(i&&a&&(i===a||i.includes(a)||a.includes(i))&&(t+=.18,s.push("Role")),typeof e.age=="number"&&typeof r.age=="number"){const l=Math.abs(e.age-r.age);l<=5?(t+=.18,s.push("Age ±5")):l<=10&&(t+=.08,s.push("Age ±10"))}const o=Math.abs((Number(e.tenure)||0)-(Number(r.tenure)||0));return o<=1?(t+=.08,s.push("Tenure ±1")):o<=3&&(t+=.04,s.push("Tenure ±3")),e.workLocation&&r.workLocation&&e.workLocation===r.workLocation?(t+=.08,s.push("Work location")):e.remotePreference&&r.remotePreference&&e.remotePreference===r.remotePreference&&(t+=.04,s.push("Work mode")),t===0&&(t=.1),{weight:Math.min(.9,t),reasons:s}}function sc(e,r,t){if(r.length===0)return{nodes:[],edges:[]};const s=new Map(e.map(c=>[c.id,c]));let i=r.slice(),a=new Set(e.map(c=>c.id)),o=!0;for(;o;){const c=new Map;i.forEach(f=>{c.set(f.source,(c.get(f.source)||0)+1),c.set(f.target,(c.get(f.target)||0)+1)});const d=new Set;if(c.forEach((f,u)=>{f>=t&&d.add(u)}),d.size===0)return{nodes:[],edges:[]};o=d.size!==a.size||[...d].some(f=>!a.has(f)),a=d,i=i.filter(f=>a.has(f.source)&&a.has(f.target))}return{nodes:[...a].map(c=>s.get(c)).filter(c=>!!c),edges:i}}function nc(e){if(!e.length)return{nodes:[],edges:[],clusters:[]};let r=e.map(m=>{const p=m.riskLevel||Pe.Low,x=m.status||"Active",j=x.toLowerCase()!=="active",k=typeof m.churnProbability=="number"?m.churnProbability:0;return{id:m.hr_code,name:m.full_name||m.name||m.hr_code,department:m.structure_name||"Unknown",position:m.position||"Unknown",riskLevel:p,churnProbability:k,status:x,isHighRisk:p===Pe.High,isResigned:j,age:m.age,managerId:m.manager_id??null,x:0,y:0}});const t=new Map;e.forEach(m=>{t.set(m.hr_code,m)});const s=new Map,i=(m,p,x,j)=>{if(!m||!p||m===p)return;const k=m<p?`${m}|${p}`:`${p}|${m}`,C=s.get(k);C?(C.weight=Math.min(1,C.weight+x),j.forEach(y=>{C.reasons.includes(y)||C.reasons.push(y)})):s.set(k,{source:m,target:p,weight:x,reasons:Array.from(new Set(j)),isRiskPath:!1})};e.forEach(m=>{if(!m.manager_id)return;const p=String(m.manager_id).trim(),x=t.get(p);x&&i(m.hr_code,x.hr_code,.9,["Manager link"])});const a=new Map;e.forEach(m=>{if(!m.manager_id)return;const p=String(m.manager_id).trim();a.has(p)||a.set(p,[]),a.get(p).push(m)}),a.forEach(m=>{if(m.length<2)return;const p=new Set;let x=tc;for(let j=0;j<m.length&&x>0;j+=1){const k=m[j];m.slice(j+1).map(y=>{const N=fs(k,y),_=Array.from(new Set(["Shared manager",...N.reasons]));return{candidate:y,weight:Math.max(.4,N.weight),reasons:_}}).sort((y,N)=>N.weight-y.weight).slice(0,2).forEach(({candidate:y,weight:N,reasons:_})=>{if(x<=0)return;const A=k.hr_code<y.hr_code?`${k.hr_code}|${y.hr_code}`:`${y.hr_code}|${k.hr_code}`;p.has(A)||(i(k.hr_code,y.hr_code,N,_),p.add(A),x-=1)})}});const o=new Map;e.forEach(m=>{const p=m.structure_name||"Unknown";o.has(p)||o.set(p,[]),o.get(p).push(m)});let l=0;o.forEach(m=>{if(m.length<2||l>=er)return;const p=new Set;for(let x=0;x<m.length&&l<er;x+=1){const j=m[x];m.slice(x+1).map(C=>{const y=fs(j,C);return{candidate:C,weight:y.weight,reasons:y.reasons}}).filter(C=>C.weight>=.18).sort((C,y)=>y.weight-C.weight).slice(0,2).forEach(({candidate:C,weight:y,reasons:N})=>{if(l>=er)return;const _=j.hr_code<C.hr_code?`${j.hr_code}|${C.hr_code}`:`${C.hr_code}|${j.hr_code}`;p.has(_)||(i(j.hr_code,C.hr_code,y,N),p.add(_),l+=1)})}});let c=Array.from(s.values());c.length>hs&&(c=c.sort((m,p)=>p.weight-m.weight).slice(0,hs));const d=sc(r,c,2);if(!d.nodes.length)return{nodes:[],edges:[],clusters:[]};r=d.nodes,c=d.edges;const f=new Map;r.forEach(m=>f.set(m.id,m)),c.forEach(m=>{const p=f.get(m.source),x=f.get(m.target);if(!p||!x)return;const j=p.isHighRisk||p.isResigned,k=x.isHighRisk||x.isResigned;m.isRiskPath=(j||k)&&m.weight>=.5});const u=Array.from(new Set(r.map(m=>m.department))),g=Math.max(1,Math.ceil(Math.sqrt(u.length))),w=Math.max(1,Math.ceil(u.length/g)),b=u.map((m,p)=>{const x=p%g,j=Math.floor(p/g),k=(x+.5)/g,C=(j+.5)/w;return{name:m,x:k,y:C}}),v=new Map;return r.forEach(m=>{v.has(m.department)||v.set(m.department,[]),v.get(m.department).push(m)}),b.forEach(m=>{const p=v.get(m.name)||[];if(p.length===1){const j=p[0];j.x=m.x,j.y=m.y;return}const x=Math.min(.18,.08+p.length*.015);p.forEach((j,k)=>{const C=2*Math.PI*k/p.length,y=Math.cos(C)*x,N=Math.sin(C)*x;j.x=Math.max(.05,Math.min(.95,m.x+y)),j.y=Math.max(.05,Math.min(.95,m.y+N))})}),{nodes:r,edges:c,clusters:b}}const ic=({employees:e,availableDepartments:r,isLoading:t})=>{const s=h.useMemo(()=>{const k=[...ec];return r.filter(C=>C&&!k.includes(C)).forEach(C=>k.push(C)),k},[r]),[i,a]=h.useState(s[0]||"All"),[o,l]=h.useState(null),c=h.useMemo(()=>i==="All"?e:e.filter(k=>(k.structure_name||"Unknown")===i),[i,e]),d=h.useMemo(()=>rc(c),[c]),{nodes:f,edges:u,clusters:g}=h.useMemo(()=>nc(d),[d]),w=c.length,b=d.length,v=b<w,m=f.length<b,p=v?`, capped at top ${yr}`:"",x=m?"Employees without at least two shared connections are hidden.":"All filtered employees meet the two-link requirement.",j=h.useMemo(()=>new Map(f.map(k=>[k.id,k])),[f]);return t?n.jsx("div",{className:"flex h-[640px] items-center justify-center rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800",children:n.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading network…"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-3 justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-300",children:[n.jsxs("span",{children:["Nodes: ",n.jsx("strong",{children:f.length})]}),n.jsxs("span",{children:["Connections: ",n.jsx("strong",{children:u.length})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[n.jsx("span",{className:"inline-flex h-3 w-3 rounded-full bg-[#ef4444]"}),"High Risk",n.jsx("span",{className:"inline-flex h-3 w-3 rounded-full bg-[#f59e0b] ml-3"}),"Medium",n.jsx("span",{className:"inline-flex h-3 w-3 rounded-full bg-[#10b981] ml-3"}),"Low"]}),n.jsxs(Re,{value:i,onValueChange:a,children:[n.jsx(ve,{className:"w-[200px]",children:n.jsx(Ae,{placeholder:"All departments"})}),n.jsx(be,{children:s.map(k=>n.jsx(Z,{value:k,children:k},k))})]})]})]}),w>0&&n.jsxs("div",{className:"rounded-md bg-blue-50 px-3 py-2 text-xs text-blue-700 dark:bg-blue-900/30 dark:text-blue-200",children:["Displaying ",f.length," of ",w," filtered employees (2+ links",p,"). ",x]}),n.jsxs("div",{className:"relative h-[640px] rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800",children:[f.length===0?n.jsx("div",{className:"flex h-full items-center justify-center text-sm text-gray-500 dark:text-gray-400",children:"No employees meet the two-link requirement yet."}):n.jsx(Ua,{children:({width:k,height:C})=>{if(!k||!C)return null;const y=72,N=A=>y+A*Math.max(k-y*2,0),_=A=>y+A*Math.max(C-y*2,0);return n.jsxs("svg",{width:k,height:C,className:"text-gray-500",children:[n.jsx("defs",{children:n.jsx("filter",{id:"nodeShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:n.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodColor:"#0f172a",floodOpacity:"0.2"})})}),u.length===0&&n.jsx("text",{x:k/2,y:C/2,textAnchor:"middle",className:"text-sm font-medium fill-gray-400 dark:fill-gray-500",children:"Not enough overlapping attributes to display connections yet."}),u.map(A=>{const E=j.get(A.source),L=j.get(A.target);if(!E||!L)return null;const O=N(E.x),$=_(E.y),T=N(L.x),V=_(L.y),z=1+A.weight*2.5,B=A.isRiskPath?"#ef4444":"#94a3b8",R=A.isRiskPath?.6:.35+A.weight*.3;return n.jsx("line",{x1:O,y1:$,x2:T,y2:V,stroke:B,strokeWidth:z,strokeOpacity:R},`${A.source}-${A.target}`)}),g.map(A=>{const E=N(A.x),L=_(A.y)-36;return n.jsx("text",{x:E,y:L,textAnchor:"middle",className:"text-xs font-medium fill-gray-500 dark:fill-gray-400",children:A.name},A.name)}),f.map(A=>{const E=N(A.x),L=_(A.y),O=10+(A.isHighRisk?4:0)+(A.isResigned?2:0),$=Ql[A.riskLevel]??"#3b82f6",T=A.isResigned?"#475569":"#1e293b";return n.jsxs("g",{transform:`translate(${E}, ${L})`,onMouseEnter:()=>l({node:A,x:E,y:L}),onMouseLeave:()=>l(null),className:"cursor-pointer",children:[n.jsx("circle",{r:O,fill:$,stroke:T,strokeWidth:A.isResigned?3:2,filter:"url(#nodeShadow)"}),n.jsx("text",{y:O+14,textAnchor:"middle",className:"text-xs font-medium fill-slate-700 dark:fill-slate-200",children:A.name})]},A.id)})]})}}),o&&n.jsxs("div",{className:"pointer-events-none absolute z-20 w-64 rounded-md border border-gray-200 bg-white p-3 text-xs shadow-lg dark:border-gray-700 dark:bg-gray-900",style:{left:o.x+16,top:o.y+16},children:[n.jsx("div",{className:"font-semibold text-gray-800 dark:text-gray-100",children:o.node.name}),n.jsxs("div",{className:"mt-1 space-y-1 text-gray-600 dark:text-gray-300",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Department:"})," ",o.node.department]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Role:"})," ",o.node.position]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Risk Score:"})," ",(o.node.churnProbability*100).toFixed(1),"%"]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Status:"})," ",o.node.status]}),typeof o.node.age=="number"&&n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Age:"})," ",o.node.age]})]}),n.jsxs("div",{className:"mt-2 border-t border-gray-200 pt-2 text-gray-500 dark:border-gray-700 dark:text-gray-400",children:[n.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-200",children:"Connections"}),n.jsx("ul",{className:"mt-1 space-y-1",children:u.filter(k=>k.source===o.node.id||k.target===o.node.id).map(k=>{const C=k.source===o.node.id?k.target:k.source,y=j.get(C);return y?n.jsxs("li",{className:"leading-snug",children:[n.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:y.name}),n.jsxs("span",{className:"ml-1 text-gray-500 dark:text-gray-400",children:["(",k.reasons.join(", "),")"]})]},`${k.source}-${k.target}`):null})})]})]})]})]})};class ac{adjustmentTimer=null;isRunning=!1;lastDataSnapshot=[];start(r){this.isRunning||(this.isRunning=!0,this.lastDataSnapshot=[...r],this.initializeIfNeeded(r),this.scheduleNextAdjustment())}stop(){this.adjustmentTimer&&(clearTimeout(this.adjustmentTimer),this.adjustmentTimer=null),this.isRunning=!1}updateData(r){this.lastDataSnapshot=[...r],this.checkForImmediateAdjustment(r)}async forceAdjustment(){return await Wt(this.lastDataSnapshot,!0)}getStatus(){const r=at(),t=this.lastDataSnapshot.length>0?Ht(this.lastDataSnapshot):void 0;return{isRunning:this.isRunning,dataSize:this.lastDataSnapshot.length,config:r,lastAnalysis:t}}async initializeIfNeeded(r){const t=at();t.enabled&&r.length>=t.minSampleSize&&await hi(r)}scheduleNextAdjustment(){const r=at();if(!r.enabled||!this.isRunning)return;const t=r.adjustmentInterval*60*60*1e3;this.adjustmentTimer=setTimeout(async()=>{await this.performScheduledAdjustment(),this.scheduleNextAdjustment()},t)}async performScheduledAdjustment(){if(!(!this.isRunning||this.lastDataSnapshot.length===0))try{const r=await Wt(this.lastDataSnapshot,!1);r.adjusted&&window.dispatchEvent(new CustomEvent("thresholds-auto-adjusted",{detail:r}))}catch{}}async checkForImmediateAdjustment(r){const t=at();if(!t.enabled||r.length<t.minSampleSize)return;const s=Ht(r);if(!s)return;const i=s.currentDistribution,a=t.targetDistribution,o=Math.abs(i.high-a.high),l=Math.abs(i.medium-a.medium),c=Math.abs(i.low-a.low),d=10;if(o>d||l>d||c>d){console.log("Significant distribution deviation detected, triggering immediate adjustment"),console.log("Current distribution:",i),console.log("Target distribution:",a);const f=await Wt(r,!0);f.adjusted&&(console.log("Immediate adjustment applied:",f.newThresholds),window.dispatchEvent(new CustomEvent("thresholds-auto-adjusted",{detail:{...f,immediate:!0}})))}}getRecommendations(){if(this.lastDataSnapshot.length===0)return{shouldAdjust:!1,recommendations:["No data available for analysis"],analysis:null};const r=Ht(this.lastDataSnapshot);if(!r)return{shouldAdjust:!1,recommendations:["No data available for analysis"],analysis:null};const t=at(),s=[],i=r.currentDistribution,a=t.targetDistribution;let o=!1;Math.abs(i.high-a.high)>5&&(o=!0,s.push(`High risk employees: Currently ${i.high.toFixed(1)}%, target ${a.high}%`)),Math.abs(i.medium-a.medium)>5&&(o=!0,s.push(`Medium risk employees: Currently ${i.medium.toFixed(1)}%, target ${a.medium}%`));const l=this.lastDataSnapshot.map(u=>u.churnProbability||0).filter(u=>u>=0&&u<=1);l.length<this.lastDataSnapshot.length*.9&&s.push("Data quality issue: Some employees missing churn probability scores");const c=ws(),d=l.filter(u=>u>c.highRisk).length,f=l.filter(u=>u<.3).length;return d/l.length>.5&&s.push("Warning: Over 50% of employees are high risk - consider model recalibration"),f/l.length>.8&&s.push("Most employees are low risk - thresholds may be too conservative"),!o&&s.length===0&&s.push("Current thresholds appear well-calibrated for your data"),{shouldAdjust:o,recommendations:s,analysis:r}}}const tr=new ac;var Fn=e=>null;Fn.displayName="Cell";var Bn=(e,r)=>{var t=kr();return(s,i)=>a=>{e?.(s,i,a),t(Di({activeIndex:String(i),activeDataKey:r,activeCoordinate:s.tooltipPosition}))}},Vn=e=>{var r=kr();return(t,s)=>i=>{e?.(t,s,i),r(Mi())}},Wn=(e,r)=>{var t=kr();return(s,i)=>a=>{e?.(s,i,a),t(Li({activeIndex:String(i),activeDataKey:r,activeCoordinate:s.tooltipPosition}))}},oc="Invariant failed";function lc(e,r){throw new Error(oc)}var cc=["x","y"];function vr(){return vr=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)({}).hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},vr.apply(null,arguments)}function ps(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,s)}return t}function ot(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ps(Object(t),!0).forEach(function(s){dc(e,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ps(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))})}return e}function dc(e,r,t){return(r=uc(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function uc(e){var r=mc(e,"string");return typeof r=="symbol"?r:r+""}function mc(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var s=t.call(e,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function hc(e,r){if(e==null)return{};var t,s,i=fc(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function fc(e,r){if(e==null)return{};var t={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(r.indexOf(s)!==-1)continue;t[s]=e[s]}return t}function pc(e,r){var{x:t,y:s}=e,i=hc(e,cc),a="".concat(t),o=parseInt(a,10),l="".concat(s),c=parseInt(l,10),d="".concat(r.height||i.height),f=parseInt(d,10),u="".concat(r.width||i.width),g=parseInt(u,10);return ot(ot(ot(ot(ot({},r),i),o?{x:o}:{}),c?{y:c}:{}),{},{height:f,width:g,name:r.name,radius:r.radius})}function Et(e){return h.createElement(zi,vr({shapeType:"rectangle",propTransformer:pc,activeClassName:"recharts-active-bar"},e))}var gc=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,i)=>{if(Vr(r))return r;var a=Vr(s)||Tt(s);return a?r(s,i):(a||lc(),t)}};function xc(e,r){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&ar(e.zIndex)?e.zIndex:r}var yc=["onMouseEnter","onMouseLeave","onClick"],vc=["value","background","tooltipPosition"],bc=["id"],wc=["onMouseEnter","onClick","onMouseLeave"];function Oe(){return Oe=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)({}).hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Oe.apply(null,arguments)}function gs(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,s)}return t}function ce(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?gs(Object(t),!0).forEach(function(s){kc(e,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):gs(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))})}return e}function kc(e,r,t){return(r=jc(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function jc(e){var r=Sc(e,"string");return typeof r=="symbol"?r:r+""}function Sc(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var s=t.call(e,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function It(e,r){if(e==null)return{};var t,s,i=Nc(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function Nc(e,r){if(e==null)return{};var t={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(r.indexOf(s)!==-1)continue;t[s]=e[s]}return t}var Cc=e=>{var{dataKey:r,name:t,fill:s,legendType:i,hide:a}=e;return[{inactive:a,dataKey:r,type:i,color:s,value:Cs(t,r),payload:e}]};function _c(e){var{dataKey:r,stroke:t,strokeWidth:s,fill:i,name:a,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:t,strokeWidth:s,fill:i,dataKey:r,nameKey:void 0,name:Cs(a,r),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function Rc(e){var r=St(Rs),{data:t,dataKey:s,background:i,allOtherBarProps:a}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=a,d=It(a,yc),f=Bn(o,s),u=Vn(l),g=Wn(c,s);if(!i||t==null)return null;var w=Qi(i);return h.createElement(Sr,{zIndex:xc(i,jr.barBackground)},t.map((b,v)=>{var{value:m,background:p,tooltipPosition:x}=b,j=It(b,vc);if(!p)return null;var k=f(b,v),C=u(b,v),y=g(b,v),N=ce(ce(ce(ce(ce({option:i,isActive:String(v)===r},j),{},{fill:"#eee"},p),w),As(d,b,v)),{},{onMouseEnter:k,onMouseLeave:C,onClick:y,dataKey:s,index:v,className:"recharts-bar-background-rectangle"});return h.createElement(Et,Oe({key:"background-bar-".concat(v)},N))}))}function Ac(e){var{showLabels:r,children:t,rects:s}=e,i=s?.map(a=>{var o={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return ce(ce({},o),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:o,fill:a.fill})});return h.createElement(sa,{value:r?i:void 0},t)}function Pc(e){var{shape:r,activeBar:t,baseProps:s,entry:i,index:a,dataKey:o}=e,l=St(Rs),c=St(ia),d=t&&String(a)===l&&(c==null||o===c),f=d?t:r;return d?h.createElement(Sr,{zIndex:jr.activeBar},h.createElement(Et,Oe({},s,{name:String(s.name)},i,{isActive:d,option:f,index:a,dataKey:o}))):h.createElement(Et,Oe({},s,{name:String(s.name)},i,{isActive:d,option:f,index:a,dataKey:o}))}function Ec(e){var{shape:r,baseProps:t,entry:s,index:i,dataKey:a}=e;return h.createElement(Et,Oe({},t,{name:String(t.name)},s,{isActive:!1,option:r,index:i,dataKey:a}))}function Ic(e){var r,{data:t,props:s}=e,i=(r=na(s))!==null&&r!==void 0?r:{},{id:a}=i,o=It(i,bc),{shape:l,dataKey:c,activeBar:d}=s,{onMouseEnter:f,onClick:u,onMouseLeave:g}=s,w=It(s,wc),b=Bn(f,c),v=Vn(g),m=Wn(u,c);return t?h.createElement(h.Fragment,null,t.map((p,x)=>h.createElement(Nt,Oe({key:"rectangle-".concat(p?.x,"-").concat(p?.y,"-").concat(p?.value,"-").concat(x),className:"recharts-bar-rectangle"},As(w,p,x),{onMouseEnter:b(p,x),onMouseLeave:v(p,x),onClick:m(p,x)}),d?h.createElement(Pc,{shape:l,activeBar:d,baseProps:o,entry:p,index:x,dataKey:c}):h.createElement(Ec,{shape:l,baseProps:o,entry:p,index:x,dataKey:c})))):null}function Oc(e){var{props:r,previousRectanglesRef:t}=e,{data:s,layout:i,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:f}=r,u=t.current,g=ea(r,"recharts-bar-"),[w,b]=h.useState(!1),v=!w,m=h.useCallback(()=>{typeof d=="function"&&d(),b(!1)},[d]),p=h.useCallback(()=>{typeof f=="function"&&f(),b(!0)},[f]);return h.createElement(Ac,{showLabels:v,rects:s},h.createElement(ta,{animationId:g,begin:o,duration:l,isActive:a,easing:c,onAnimationEnd:m,onAnimationStart:p,key:g},x=>{var j=x===1?s:s?.map((k,C)=>{var y=u&&u[C];if(y)return ce(ce({},k),{},{x:De(y.x,k.x,x),y:De(y.y,k.y,x),width:De(y.width,k.width,x),height:De(y.height,k.height,x)});if(i==="horizontal"){var N=De(0,k.height,x),_=De(k.stackedBarStart,k.y,x);return ce(ce({},k),{},{y:_,height:N})}var A=De(0,k.width,x),E=De(k.stackedBarStart,k.x,x);return ce(ce({},k),{},{width:A,x:E})});return x>0&&(t.current=j??null),j==null?null:h.createElement(Nt,null,h.createElement(Ic,{props:r,data:j}))}),h.createElement(ra,{label:r.label}),r.children)}function Tc(e){var r=h.useRef(null);return h.createElement(Oc,{previousRectanglesRef:r,props:e})}var Hn=0,Dc=(e,r)=>{var t=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:t,errorVal:_s(e,r)}};class Mc extends h.PureComponent{render(){var{hide:r,data:t,dataKey:s,className:i,xAxisId:a,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(r||t==null)return null;var f=Ai("recharts-bar",i),u=d;return h.createElement(Nt,{className:f,id:d},l&&h.createElement("defs",null,h.createElement(Xi,{clipPathId:u,xAxisId:a,yAxisId:o})),h.createElement(Nt,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(u,")"):void 0},h.createElement(Rc,{data:t,dataKey:s,background:c,allOtherBarProps:this.props}),h.createElement(Tc,this.props)))}}var Lc={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ui.isSsr,legendType:"rect",minPointSize:Hn,xAxisId:0,yAxisId:0,zIndex:jr.bar};function zc(e){var{xAxisId:r,yAxisId:t,hide:s,legendType:i,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:f}=e,{needClip:u}=Ki(r,t),g=Gi(),w=Ns(),b=qi(e.children,Fn),v=St(x=>md(x,r,t,w,e.id,b));if(g!=="vertical"&&g!=="horizontal")return null;var m,p=v?.[0];return p==null||p.height==null||p.width==null?m=0:m=g==="vertical"?p.height/2:p.width/2,h.createElement(Yi,{xAxisId:r,yAxisId:t,data:v,dataPointFormatter:Dc,errorBarOffset:m},h.createElement(Mc,Oe({},e,{layout:g,needClip:u,data:v,xAxisId:r,yAxisId:t,hide:s,legendType:i,minPointSize:a,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:f})))}function $c(e){var{layout:r,barSettings:{dataKey:t,minPointSize:s},pos:i,bandSize:a,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:f,displayedData:u,offset:g,cells:w,parentViewBox:b,dataStartIndex:v}=e,m=r==="horizontal"?l:o,p=f?m.scale.domain():null,x=Zi({numericAxis:m}),j=m.scale(x);return u.map((k,C)=>{var y,N,_,A,E,L;f?y=Ji(f[C+v],p):(y=_s(k,t),Array.isArray(y)||(y=[x,y]));var O=gc(s,Hn)(y[1],C);if(r==="horizontal"){var $,[T,V]=[l.scale(y[0]),l.scale(y[1])];N=Wr({axis:o,ticks:c,bandSize:a,offset:i.offset,entry:k,index:C}),_=($=V??T)!==null&&$!==void 0?$:void 0,A=i.size;var z=T-V;if(E=aa(z)?0:z,L={x:N,y:g.top,width:A,height:g.height},Math.abs(O)>0&&Math.abs(E)<Math.abs(O)){var B=Hr(E||O)*(Math.abs(O)-Math.abs(E));_-=B,E+=B}}else{var[R,D]=[o.scale(y[0]),o.scale(y[1])];if(N=R,_=Wr({axis:l,ticks:d,bandSize:a,offset:i.offset,entry:k,index:C}),A=D-R,E=i.size,L={x:g.left,y:_,width:g.width,height:E},Math.abs(O)>0&&Math.abs(A)<Math.abs(O)){var H=Hr(A||O)*(Math.abs(O)-Math.abs(A));A+=H}}if(N==null||_==null||A==null||E==null)return null;var se=ce(ce({},k),{},{stackedBarStart:j,x:N,y:_,width:A,height:E,value:f?y:y[1],payload:k,background:L,tooltipPosition:{x:N+A/2,y:_+E/2},parentViewBox:b},w&&w[C]&&w[C].props);return se}).filter(Boolean)}function Fc(e){var r=$i(e,Lc),t=Ns();return h.createElement(Fi,{id:r.id,type:"bar"},s=>h.createElement(h.Fragment,null,h.createElement(Bi,{legendPayload:Cc(r)}),h.createElement(Vi,{fn:_c,args:r}),h.createElement(Wi,{type:"bar",id:s,data:void 0,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,stackId:Hi(r.stackId),hide:r.hide,barSize:r.barSize,minPointSize:r.minPointSize,maxBarSize:r.maxBarSize,isPanorama:t}),h.createElement(Sr,{zIndex:r.zIndex},h.createElement(zc,Oe({},r,{id:s})))))}var wt=h.memo(Fc);wt.displayName="Bar";function xs(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,s)}return t}function vt(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?xs(Object(t),!0).forEach(function(s){Bc(e,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xs(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))})}return e}function Bc(e,r,t){return(r=Vc(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Vc(e){var r=Wc(e,"string");return typeof r=="symbol"?r:r+""}function Wc(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var s=t.call(e,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Hc=(e,r)=>r,Uc=(e,r,t)=>t,Kc=(e,r,t,s)=>s,Gc=(e,r,t,s,i)=>i,pt=ze([Es,Gc],(e,r)=>e.filter(t=>t.type==="bar").find(t=>t.id===r)),qc=ze([pt],e=>e?.maxBarSize),Yc=(e,r,t,s,i,a)=>a,ys=(e,r,t)=>{var s=t??e;if(!Tt(s))return or(s,r,0)},Xc=ze([tt,Es,Hc,Uc,Kc],(e,r,t,s,i)=>r.filter(a=>e==="horizontal"?a.xAxisId===t:a.yAxisId===s).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),Zc=(e,r,t,s)=>{var i=tt(e);return i==="horizontal"?Ur(e,"yAxis",t,s):Ur(e,"xAxis",r,s)},Jc=(e,r,t)=>{var s=tt(e);return s==="horizontal"?Kr(e,"xAxis",r):Kr(e,"yAxis",t)},Qc=(e,r,t)=>{var s={},i=e.filter(fa),a=e.filter(d=>d.stackId==null),o=i.reduce((d,f)=>(d[f.stackId]||(d[f.stackId]=[]),d[f.stackId].push(f),d),s),l=Object.entries(o).map(d=>{var[f,u]=d,g=u.map(b=>b.dataKey),w=ys(r,t,u[0].barSize);return{stackId:f,dataKeys:g,barSize:w}}),c=a.map(d=>{var f=[d.dataKey].filter(g=>g!=null),u=ys(r,t,d.barSize);return{stackId:void 0,dataKeys:f,barSize:u}});return[...l,...c]},ed=ze([Xc,ha,Jc],Qc),td=(e,r,t,s,i)=>{var a,o,l=pt(e,r,t,s,i);if(l!=null){var c=tt(e),d=Is(e),{maxBarSize:f}=l,u=Tt(f)?d:f,g,w;return c==="horizontal"?(g=Je(e,"xAxis",r,s),w=Qe(e,"xAxis",r,s)):(g=Je(e,"yAxis",t,s),w=Qe(e,"yAxis",t,s)),(a=(o=Ps(g,w,!0))!==null&&o!==void 0?o:u)!==null&&a!==void 0?a:0}},Un=(e,r,t,s)=>{var i=tt(e),a,o;return i==="horizontal"?(a=Je(e,"xAxis",r,s),o=Qe(e,"xAxis",r,s)):(a=Je(e,"yAxis",t,s),o=Qe(e,"yAxis",t,s)),Ps(a,o)};function rd(e,r,t,s,i){var a=s.length;if(!(a<1)){var o=or(e,t,0,!0),l,c=[];if(ar(s[0].barSize)){var d=!1,f=t/a,u=s.reduce((p,x)=>p+(x.barSize||0),0);u+=(a-1)*o,u>=t&&(u-=(a-1)*o,o=0),u>=t&&f>0&&(d=!0,f*=.9,u=a*f);var g=(t-u)/2>>0,w={offset:g-o,size:0};l=s.reduce((p,x)=>{var j,k={stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:w.offset+w.size+o,size:d?f:(j=x.barSize)!==null&&j!==void 0?j:0}},C=[...p,k];return w=C[C.length-1].position,C},c)}else{var b=or(r,t,0,!0);t-2*b-(a-1)*o<=0&&(o=0);var v=(t-2*b-(a-1)*o)/a;v>1&&(v>>=0);var m=ar(i)?Math.min(v,i):v;l=s.reduce((p,x,j)=>[...p,{stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:b+(v+o)*j+(v-m)/2,size:m}}],c)}return l}}var sd=(e,r,t,s,i,a,o)=>{var l=Tt(o)?r:o,c=rd(t,s,i!==a?i:a,e,l);return i!==a&&c!=null&&(c=c.map(d=>vt(vt({},d),{},{position:vt(vt({},d.position),{},{offset:d.position.offset-i/2})}))),c},nd=ze([ed,Is,da,ua,td,Un,qc],sd),id=(e,r,t,s)=>Je(e,"xAxis",r,s),ad=(e,r,t,s)=>Je(e,"yAxis",t,s),od=(e,r,t,s)=>Qe(e,"xAxis",r,s),ld=(e,r,t,s)=>Qe(e,"yAxis",t,s),cd=ze([nd,pt],(e,r)=>{if(!(e==null||r==null)){var t=e.find(s=>s.stackId===r.stackId&&r.dataKey!=null&&s.dataKeys.includes(r.dataKey));if(t!=null)return t.position}}),dd=(e,r)=>{var t=ma(r);if(!(!e||t==null||r==null)){var{stackId:s}=r;if(s!=null){var i=e[s];if(i){var{stackedData:a}=i;if(a)return a.find(o=>o.key===t)}}}},ud=ze([Zc,pt],dd),md=ze([oa,la,id,ad,od,ld,cd,tt,ca,Un,ud,pt,Yc],(e,r,t,s,i,a,o,l,c,d,f,u,g)=>{var{chartData:w,dataStartIndex:b,dataEndIndex:v}=c;if(!(u==null||o==null||r==null||l!=="horizontal"&&l!=="vertical"||t==null||s==null||i==null||a==null||d==null)){var{data:m}=u,p;if(m!=null&&m.length>0?p=m:p=w?.slice(b,v+1),p!=null)return $c({layout:l,barSettings:u,pos:o,parentViewBox:r,bandSize:d,xAxis:t,yAxis:s,xAxisTicks:i,yAxisTicks:a,stackedData:f,displayedData:p,offset:e,cells:g,dataStartIndex:b})}}),hd=["axis","item"],rr=h.forwardRef((e,r)=>h.createElement(pa,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:hd,tooltipPayloadSearcher:ga,categoricalChartProps:e,ref:r}));async function fd(e,r={highRisk:.7,mediumRisk:.4}){try{const t=vd(e,r);return{id:`churn-patterns-${Date.now()}`,type:"churn-patterns",title:"Advanced Churn Pattern Analysis",summary:`Comprehensive analysis of ${e.length} employees with advanced pattern detection. Identified ${t.insights.length} key insights and ${t.recommendations.length} actionable recommendations.`,insights:t.insights,recommendations:t.recommendations,visualizations:t.visualizations,confidence:.92,timestamp:new Date,executionTime:1500,dataSources:[{type:"employee_data",name:"Employee Records",available:!0,recordCount:e.length,lastUpdated:new Date}],parameters:{thresholds:{highRisk:`${Math.round(r.highRisk*100)}%`,mediumRisk:`${Math.round(r.mediumRisk*100)}%`},analysisType:"comprehensive_pattern_analysis",departmentAnalysis:t.metrics.deptRisks.slice(0,5).map(s=>({department:s.dept,avgRisk:`${s.avgRisk}%`,count:s.count,highRiskCount:s.highRiskCount,mediumRiskCount:s.mediumRiskCount})),positionAnalysis:t.metrics.positionRisks.slice(0,5).map(s=>({position:s.position,avgRisk:`${s.avgRisk}%`,count:s.count})),tenureAnalysis:t.metrics.tenureRisks.map(s=>({group:s.group,avgRisk:`${s.avgRisk}%`,count:s.count}))}}}catch(t){throw t}}async function pd(e){try{return{id:`engagement-correlation-${Date.now()}`,type:"engagement-correlation",title:"Engagement Correlation Analysis",summary:`Analyzed correlation between engagement and churn risk for ${e.length} employees.`,insights:[{id:"1",title:"Limited Engagement Data",description:"Engagement survey data not available for comprehensive correlation analysis."}],recommendations:[{id:"1",title:"Upload Engagement Data",description:"Upload engagement survey data to enable correlation analysis."}],confidence:.3,timestamp:new Date,executionTime:1e3}}catch{return Vt("engagement-correlation",e.length)}}async function gd(e,r,t){try{const s=r.slice(1).map(i=>{const a=e.filter(l=>(l.structure_name||l.department)===i),o=a.reduce((l,c)=>l+(c.churnProbability||0),0)/(a.length||1);return{department:i,avgRisk:o,count:a.length}}).sort((i,a)=>a.avgRisk-i.avgRisk);return{id:`org-insights-${Date.now()}`,type:"organizational-insights",title:"Organizational Insights",summary:`Comprehensive analysis of ${e.length} employees across ${r.length-1} departments.`,insights:[{id:"1",title:"Department Risk Analysis",description:`${s[0]?.department||"Unknown"} shows highest average risk at ${((s[0]?.avgRisk||0)*100).toFixed(1)}%`},{id:"2",title:"Risk Distribution",description:`${t.high_risk_count} high-risk employees (${(t.high_risk_count/t.total_employees*100).toFixed(1)}% of workforce)`}],recommendations:[{id:"1",title:"Focus on High-Risk Departments",description:"Implement targeted retention strategies for departments with elevated risk levels."},{id:"2",title:"Individual Risk Assessment",description:"Conduct detailed assessments for high-risk employees."}],confidence:.8,timestamp:new Date,executionTime:3e3}}catch{return Vt("organizational-insights",e.length)}}async function xd(e){try{return{id:`cross-analysis-${Date.now()}`,type:"cross-source",title:"Cross-Source Analysis",summary:`Cross-analysis requires multiple data sources. Currently analyzing ${e.length} employees from primary dataset.`,insights:[{id:"1",title:"Single Data Source",description:"Analysis limited to employee churn data. Additional data sources needed for comprehensive cross-analysis."}],recommendations:[{id:"1",title:"Add Data Sources",description:"Upload engagement surveys, interview data, or performance metrics for enhanced analysis."}],confidence:.4,timestamp:new Date,executionTime:1500}}catch{return Vt("cross-source",e.length)}}async function yd(e,r){try{return{id:`general-analysis-${Date.now()}`,type:e,title:`${e.replace("-"," ").replace(/\b\w/g,t=>t.toUpperCase())} Analysis`,summary:`General analysis completed for ${r.length} employees.`,insights:[{id:"1",title:"Analysis Complete",description:`${e} analysis has been completed with available data.`}],recommendations:[{id:"1",title:"Review Results",description:"Review the analysis results and consider implementing recommended actions."}],confidence:.7,timestamp:new Date,executionTime:2e3}}catch{return Vt(e,r.length)}}function vd(e,r={highRisk:.7,mediumRisk:.4}){const t=[],s=[],i=[],a=e.filter(y=>(y.churnProbability||0)>r.highRisk),o=e.filter(y=>{const N=y.churnProbability||0;return N>r.mediumRisk&&N<=r.highRisk}),l=e.filter(y=>(y.churnProbability||0)<=r.mediumRisk),c=e.length,d=Math.round(a.length/c*100*100)/100,f=Math.round(o.length/c*100*100)/100,u=Math.round(e.reduce((y,N)=>y+(N.churnProbability||0),0)/e.length*100*100)/100,g=Math.round(e.reduce((y,N)=>{const _=(N.churnProbability||0)-u/100;return y+_*_},0)/e.length*100*100)/100;if(a.length>0){const y=Math.round(a.reduce((_,A)=>_+(A.churnProbability||0),0)/a.length*100*100)/100,N=Math.round(Math.max(...a.map(_=>_.churnProbability||0))*100*100)/100;t.push({id:"high-risk-pattern",title:"Critical Risk Concentration",description:`${a.length} employees (${d}%) show critical churn risk (>${Math.round(r.highRisk*100)}%). Average risk: ${y}%, Max risk: ${N}%. Immediate intervention required.`,severity:"critical",confidence:.95,impact:"high"}),s.push({id:"high-risk-action",title:"Immediate Retention Intervention",description:`Implement urgent retention strategies for ${a.length} high-risk employees. Focus on personalized engagement, career development, and competitive compensation. Priority: Critical.`,priority:"critical",timeframe:"immediate",impact:"high"})}if(o.length>0){const y=Math.round(o.reduce((N,_)=>N+(_.churnProbability||0),0)/o.length*100*100)/100;t.push({id:"medium-risk-pattern",title:"Elevated Risk Population",description:`${o.length} employees (${f}%) show elevated churn risk (${Math.round(r.mediumRisk*100)}-${Math.round(r.highRisk*100)}%). Average risk: ${y}%. This represents a significant retention opportunity.`,severity:"high",confidence:.88,impact:"medium"}),s.push({id:"medium-risk-action",title:"Proactive Retention Strategy",description:`Develop targeted retention programs for ${o.length} medium-risk employees. Implement regular check-ins, career development initiatives, and recognition programs.`,priority:"high",timeframe:"1-2 weeks",impact:"medium"})}const w=e.reduce((y,N)=>{const _=N.structure_name||N.department||"Unknown";return y[_]||(y[_]=[]),y[_].push(N),y},{}),b=Object.entries(w).map(([y,N])=>{const _=N,A=Math.round(_.reduce((O,$)=>O+($.churnProbability||0),0)/_.length*100*100)/100,E=_.filter(O=>(O.churnProbability||0)>r.highRisk).length,L=_.filter(O=>{const $=O.churnProbability||0;return $>r.mediumRisk&&$<=r.highRisk}).length;return{dept:y,avgRisk:A,count:_.length,highRiskCount:E,mediumRiskCount:L,riskPercentage:Math.round((E+L)/_.length*100*100)/100}}).sort((y,N)=>N.avgRisk-y.avgRisk);if(b.length>0){const y=b[0],N=b[b.length-1];y.avgRisk>u/100*1.2&&(t.push({id:"dept-risk-concentration",title:"Department Risk Concentration",description:`${y.dept} department shows significantly elevated risk (${y.avgRisk}% vs ${u}% org average). ${y.highRiskCount} critical and ${y.mediumRiskCount} elevated risk employees.`,severity:"high",confidence:.92,impact:"high"}),s.push({id:"dept-intervention",title:"Department-Level Retention Program",description:`Implement comprehensive retention program for ${y.dept} department. Focus on leadership engagement, career development, and competitive compensation.`,priority:"high",timeframe:"2-4 weeks",impact:"high"})),N.avgRisk<u/100*.8&&t.push({id:"dept-best-practices",title:"Department Best Practices Identified",description:`${N.dept} department shows excellent retention practices (${N.avgRisk}% risk vs ${u}% org average). Consider replicating their strategies.`,severity:"low",confidence:.85,impact:"medium"})}const v=e.reduce((y,N)=>{const _=N.position||"Unknown";return y[_]||(y[_]=[]),y[_].push(N),y},{}),m=Object.entries(v).filter(([y,N])=>N.length>=3).map(([y,N])=>{const _=N,A=Math.round(_.reduce((E,L)=>E+(L.churnProbability||0),0)/_.length*100*100)/100;return{position:y,avgRisk:A,count:_.length}}).sort((y,N)=>N.avgRisk-y.avgRisk);if(m.length>0){const y=m[0];y.avgRisk>u/100*1.3&&(t.push({id:"position-risk-pattern",title:"Position-Based Risk Pattern",description:`${y.position} role shows significantly elevated churn risk (${y.avgRisk}% vs ${u}% org average). ${y.count} employees affected.`,severity:"medium",confidence:.78,impact:"medium"}),s.push({id:"position-retention",title:"Role-Specific Retention Strategy",description:`Develop targeted retention strategies for ${y.position} role. Consider compensation review, career progression, and role satisfaction factors.`,priority:"medium",timeframe:"1-3 weeks",impact:"medium"}))}const p=e.reduce((y,N)=>{const _=N.tenure||0;let A="Unknown";return _<1?A="New (< 1 year)":_<3?A="Early (1-3 years)":_<5?A="Mid (3-5 years)":A="Senior (5+ years)",y[A]||(y[A]=[]),y[A].push(N),y},{}),x=Object.entries(p).map(([y,N])=>{const _=N,A=Math.round(_.reduce((E,L)=>E+(L.churnProbability||0),0)/_.length*100*100)/100;return{group:y,avgRisk:A,count:_.length}}).sort((y,N)=>N.avgRisk-y.avgRisk);if(x.length>0){const y=x[0];y.avgRisk>u/100*1.2&&(t.push({id:"tenure-risk-pattern",title:"Tenure-Based Risk Pattern",description:`${y.group} employees show elevated churn risk (${y.avgRisk}% vs ${u}% org average). ${y.count} employees affected.`,severity:"medium",confidence:.82,impact:"medium"}),s.push({id:"tenure-retention",title:"Tenure-Specific Engagement",description:`Develop targeted engagement strategies for ${y.group} employees. Focus on career development, recognition, and retention incentives.`,priority:"medium",timeframe:"2-4 weeks",impact:"medium"}))}t.push({id:"overall-risk-assessment",title:"Organizational Risk Assessment",description:`Overall churn risk: ${u}%. High-risk employees: ${a.length} (${d}%), Medium-risk employees: ${o.length} (${f}%), Low-risk employees: ${l.length} (${Math.round(l.length/c*100*100)/100}%).`,severity:u/100>.5?"high":u/100>.3?"medium":"low",confidence:.9,impact:"high"}),d>10&&s.push({id:"strategic-intervention",title:"Strategic Retention Initiative",description:`High-risk population (${d}%) requires strategic intervention. Consider organizational culture, compensation, and career development programs.`,priority:"critical",timeframe:"1-2 months",impact:"high"}),f>30&&s.push({id:"proactive-strategy",title:"Proactive Retention Strategy",description:`Large medium-risk population (${f}%) presents opportunity for proactive retention. Implement comprehensive engagement programs.`,priority:"high",timeframe:"1-3 months",impact:"high"});const j=()=>n.jsx(Ut,{width:"100%",height:300,children:n.jsxs(rr,{data:b.slice(0,10).map(y=>({name:y.dept,risk:y.avgRisk,count:y.count,highRisk:y.highRiskCount,mediumRisk:y.mediumRiskCount})),children:[n.jsx(Kt,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),n.jsx(Gt,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:{fontSize:11},stroke:"#6b7280"}),n.jsx(qt,{tick:{fontSize:11},stroke:"#6b7280",label:{value:"Risk %",angle:-90,position:"insideLeft",style:{textAnchor:"middle"}}}),n.jsx(Yt,{formatter:(y,N)=>[`${y}%`,N==="risk"?"Average Risk":N]}),n.jsx(wt,{dataKey:"risk",fill:"#3b82f6",name:"Average Risk",radius:[4,4,0,0]})]})}),k=()=>n.jsx(Ut,{width:"100%",height:300,children:n.jsxs(rr,{data:m.slice(0,8).map(y=>({name:y.position,risk:y.avgRisk,count:y.count})),children:[n.jsx(Kt,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),n.jsx(Gt,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:{fontSize:11},stroke:"#6b7280"}),n.jsx(qt,{tick:{fontSize:11},stroke:"#6b7280",label:{value:"Risk %",angle:-90,position:"insideLeft",style:{textAnchor:"middle"}}}),n.jsx(Yt,{formatter:(y,N)=>[`${y}%`,N==="risk"?"Average Risk":N]}),n.jsx(wt,{dataKey:"risk",fill:"#10b981",name:"Average Risk",radius:[4,4,0,0]})]})}),C=()=>n.jsx(Ut,{width:"100%",height:300,children:n.jsxs(rr,{data:x.map(y=>({name:y.group,risk:y.avgRisk,count:y.count})),children:[n.jsx(Kt,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),n.jsx(Gt,{dataKey:"name",tick:{fontSize:11},stroke:"#6b7280"}),n.jsx(qt,{tick:{fontSize:11},stroke:"#6b7280",label:{value:"Risk %",angle:-90,position:"insideLeft",style:{textAnchor:"middle"}}}),n.jsx(Yt,{formatter:(y,N)=>[`${y}%`,N==="risk"?"Average Risk":N]}),n.jsx(wt,{dataKey:"risk",fill:"#f59e0b",name:"Average Risk",radius:[4,4,0,0]})]})});return i.push({id:"department-risk",type:"bar-chart",title:"Department Risk Comparison",component:j,data:b.slice(0,10).map(y=>({name:y.dept,value:y.avgRisk,count:y.count}))}),i.push({id:"position-risk",type:"bar-chart",title:"Position Risk Analysis",component:k,data:m.slice(0,8).map(y=>({name:y.position,value:y.avgRisk,count:y.count}))}),i.push({id:"tenure-risk",type:"bar-chart",title:"Tenure Risk Analysis",component:C,data:x.map(y=>({name:y.group,value:y.avgRisk,count:y.count}))}),{insights:t,recommendations:s,visualizations:i,metrics:{totalEmployees:c,avgRisk:u,riskVariance:g,highRiskCount:a.length,mediumRiskCount:o.length,lowRiskCount:l.length,highRiskPercentage:d,mediumRiskPercentage:f,deptRisks:b,positionRisks:m,tenureRisks:x}}}function Vt(e,r){return{id:`fallback-${e}-${Date.now()}`,type:e,title:`${e.replace("-"," ").replace(/\b\w/g,t=>t.toUpperCase())} Analysis`,summary:`Analysis completed for ${r} employees. Limited insights due to processing constraints.`,insights:[{id:"1",title:"Analysis Completed",description:"Basic analysis has been completed with available data."}],recommendations:[{id:"1",title:"Review Data Quality",description:"Ensure data quality and completeness for better analysis results."}],confidence:.5,timestamp:new Date,executionTime:1e3}}const bd=h.memo(({employee:e,onReasoningClick:r,style:t,getRiskLevel:s,getRiskLevelWithStyles:i})=>{const a=isNaN(e.churnProbability)?0:e.churnProbability,o=i(a),l=s(a),c=!e.full_name||e.full_name.includes("Unknown")||!e.structure_name||!e.position,d=h.useMemo(()=>e.reasoningConfidence?Math.round(e.reasoningConfidence*100):e.confidenceScore||0,[e.reasoningConfidence,e.confidenceScore]),f=h.useMemo(()=>d>=80?"bg-green-500":d>=60?"bg-blue-500":d>=40?"bg-yellow-500":"bg-red-500",[d]),u=h.useCallback(g=>{g.stopPropagation(),r(e)},[r,e]);return n.jsxs("div",{style:t,className:W("flex items-center border-b border-gray-100 dark:border-gray-700/80",`hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors ${c?"bg-red-50 dark:bg-red-900/10":""} cursor-pointer`),onClick:()=>r(e),children:[n.jsx("div",{className:"px-6 py-3 text-sm font-medium text-gray-900 dark:text-gray-100 truncate w-[20%]",children:e.full_name||n.jsx("span",{className:"text-red-500 dark:text-red-400 flex items-center gap-1",children:" Missing Name"})}),n.jsx("div",{className:"px-6 py-3 text-sm text-gray-600 dark:text-gray-400 truncate w-[15%]",children:e.structure_name||"Unassigned"}),n.jsx("div",{className:"px-6 py-3 text-sm text-gray-600 dark:text-gray-400 truncate w-[15%]",children:e.position||"Unassigned"}),n.jsx("div",{className:"px-6 py-3 w-[10%]",children:n.jsx("span",{className:W("px-2.5 py-0.5 text-xs font-medium rounded-full inline-block",`${o.color} ${o.bgColor} ${o.darkColor} ${o.darkBgColor}`),children:l})}),n.jsx("div",{className:"px-6 py-3 w-[15%]",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-200",children:[(a*100).toFixed(1),"%"]}),n.jsxs("div",{className:"flex items-center gap-1.5 bg-blue-50 dark:bg-blue-900/30 px-2 py-0.5 rounded-md border border-blue-200 dark:border-blue-800",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${f}`}),n.jsxs("span",{className:"text-xs text-blue-700 dark:text-blue-300 whitespace-nowrap font-medium",children:[d,"% conf."]})]})]})}),n.jsx("div",{className:"px-6 py-3 text-sm text-gray-600 dark:text-gray-400 w-[10%]",children:e.status||"Active"}),n.jsx("div",{className:"px-6 py-3 w-[15%]",children:n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("button",{onClick:u,className:"flex items-center gap-1 px-2 py-1 text-xs bg-purple-100 hover:bg-purple-200 dark:bg-purple-900/30 dark:hover:bg-purple-800/50 text-purple-700 dark:text-purple-300 rounded transition-colors",children:[n.jsx(dt,{className:"w-3 h-3"}),"Reasoning"]})})})]})}),wd=h.memo(()=>n.jsxs("div",{className:"bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 -mx-6 -mt-6 px-8 py-8 border-b border-gray-700/50 relative overflow-hidden",children:[n.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,#4f4f4f2e_1px,transparent_1px),linear-gradient(to_bottom,#4f4f4f2e_1px,transparent_1px)] bg-[size:14px_24px] [mask-image:radial-gradient(ellipse_60%_50%_at_50%_0%,#000_70%,transparent_100%)]"}),n.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-gray-500/50 to-transparent"})]}),n.jsx("div",{className:"relative",children:n.jsx("div",{className:"flex justify-between items-center",children:n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx(Q.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-200 via-blue-400 to-blue-200 animate-gradient",children:"ChurnVision - Employee Churn Risk Dashboard"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Q.span,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"relative group",children:[n.jsxs("span",{className:"px-2.5 py-1 text-xs font-semibold bg-sky-500/10 text-sky-300 rounded-md border border-sky-500/30 relative z-10 flex items-center gap-1.5 shadow-sm group-hover:bg-sky-500/20 transition-all duration-200",children:[n.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-400 block animate-pulse group-hover:animate-none"}),"Pulse"]}),n.jsx("div",{className:"absolute inset-0 bg-sky-500/20 rounded-md blur-sm opacity-70 group-hover:opacity-100 transition-opacity duration-200"})]}),n.jsxs(Q.span,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:"relative group",children:[n.jsxs("span",{className:"px-2.5 py-1 text-xs font-medium bg-emerald-500/10 text-emerald-300 rounded-md border border-emerald-500/30 relative z-10 flex items-center gap-1.5 shadow-sm group-hover:bg-emerald-500/20 transition-all duration-200",children:[n.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400 block animate-pulse group-hover:animate-none"}),"ML-Based"]}),n.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 rounded-md blur-sm opacity-70 group-hover:opacity-100 transition-opacity duration-200"})]})]})]}),n.jsx(Q.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-base text-gray-400 max-w-2xl",children:"Step into the future of talent retention. Our AI-driven platform empowers you to monitor and analyze employee churn risk factors with unprecedented precision."})]})})})]})),sr=({title:e,count:r,total:t,colorClass:s})=>{const i=t>0?r/t*100:0;return n.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:W("bg-white dark:bg-gray-800/50 p-4 rounded-lg border h-full min-h-[90px]","border-gray-200/75 dark:border-gray-700/50 shadow-xs"),children:[n.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:e}),n.jsxs("div",{className:"flex items-center space-x-3",children:[" ",n.jsxs("div",{className:"flex-grow h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:[" ",n.jsx(Q.div,{className:`h-full rounded-full bg-${s}-500 dark:bg-${s}-600`,initial:{width:0},animate:{width:`${i}%`},transition:{duration:.8,ease:"easeOut"},title:`${i.toFixed(1)}%`})]}),n.jsx("p",{className:"text-base font-semibold text-gray-700 dark:text-gray-300 flex-shrink-0 w-10 text-right",children:r})]})]})};function kd(e,r){const[t,s]=h.useState(e);return h.useEffect(()=>{const i=setTimeout(()=>{s(e)},r);return()=>{clearTimeout(i)}},[e,r]),t}function Rd(){const{activeProject:e}=fi(),{homeEmployees:r,isLoadingHomeData:t,isEnhancingWithReasoning:s,reasoningEnhancementProgress:i,fetchHomeData:a,trainingStatus:o}=pi(),l=xi,c=vi,[d,f]=h.useState(0),[u,g]=h.useState("dashboard"),w=S=>{g(S)},[b,v]=h.useState(""),[m,p]=h.useState({departmentFilter:"all-departments",timePeriod:"last-12-months",riskLevel:"all-risk-levels",employeeGroup:"all-employees"}),[x,j]=h.useState(!1),[k,C]=h.useState(null),[y,N]=h.useState(""),[_,A]=h.useState(""),[E,L]=h.useState(""),[O,$]=h.useState(""),[T,V]=h.useState("Active"),[z,B]=h.useState("churnProbability"),[R,D]=h.useState("desc");h.useEffect(()=>{const S=gi(()=>{f(P=>P+1)});return()=>{S()}},[]);const[H,se]=h.useState(!1),[G]=h.useState(null),[ee,te]=h.useState(!1),[X,le]=h.useState(""),M=kd(y,300),q=h.useRef(null),ne=h.useMemo(()=>(r||[]).some(S=>S?.hasReasoningData||typeof S?.reasoningChurnRisk=="number"),[r]),K=o?.status==="complete"||ne;h.useEffect(()=>{if(!e)return;(async()=>{try{new URLSearchParams(window.location.search).get("refresh")==="true"?(await a(e.id,!0),window.history.replaceState({},document.title,window.location.pathname)):await a(e.id,!1)}catch{}})()},[e,a]);const U=r||[],Y=t,ie=h.useMemo(()=>U.some(S=>typeof S?.churnProbability=="number"||typeof S?.reasoningChurnRisk=="number"||S?.hasReasoningData),[U]),re=h.useMemo(()=>{if(!M)return U;const S=M.toLowerCase();return U.filter(P=>{const I=P.full_name||"",F=P.structure_name||"",J=P.position||"";return I.toLowerCase().includes(S)||F.toLowerCase().includes(S)||J.toLowerCase().includes(S)})},[U,M]),Ce=h.useMemo(()=>{let S=re;E&&E!=="All"&&(S=S.filter(I=>(I.position||"Unassigned")===E)),O&&O!=="All"&&(S=S.filter(I=>l(I.churnProbability||0)===O)),T&&T!=="All"&&(S=S.filter(I=>(I.status||"Active")===T));const P=new Set;return S.forEach(I=>{P.add(I.structure_name||I.department||"Unassigned")}),["All",...Array.from(P).sort()]},[re,E,O,T,l,d]),Ue=h.useMemo(()=>{let S=re;_&&_!=="All"&&(S=S.filter(I=>(I.structure_name||I.department||"Unassigned")===_)),O&&O!=="All"&&(S=S.filter(I=>l(I.churnProbability||0)===O)),T&&T!=="All"&&(S=S.filter(I=>(I.status||"Active")===T));const P=new Set;return S.forEach(I=>{P.add(I.position||"Unassigned")}),["All",...Array.from(P).sort()]},[re,_,O,T,l,d]),Ke=h.useMemo(()=>{let S=re;_&&_!=="All"&&(S=S.filter(I=>(I.structure_name||I.department||"Unassigned")===_)),E&&E!=="All"&&(S=S.filter(I=>(I.position||"Unassigned")===E)),T&&T!=="All"&&(S=S.filter(I=>(I.status||"Active")===T));const P=new Set;return S.forEach(I=>{const F=l(I.churnProbability||0);P.add(F)}),["All",...Array.from(P).sort()]},[re,_,E,T,l,d]),Kn=h.useMemo(()=>{let S=re;_&&_!=="All"&&(S=S.filter(I=>(I.structure_name||I.department||"Unassigned")===_)),E&&E!=="All"&&(S=S.filter(I=>(I.position||"Unassigned")===E)),O&&O!=="All"&&(S=S.filter(I=>l(I.churnProbability||0)===O));const P=new Set;return S.forEach(I=>{P.add(I.status||"Active")}),["All",...Array.from(P).sort()]},[re,_,E,O,l,d]),_e=h.useMemo(()=>{let S=re;return _&&_!=="All"&&(S=S.filter(P=>(P.structure_name||P.department||"Unassigned")===_)),E&&E!=="All"&&(S=S.filter(P=>(P.position||"Unassigned")===E)),O&&O!=="All"&&(S=S.filter(P=>l(P.churnProbability||0)===O)),T&&T!=="All"&&(S=S.filter(P=>(P.status||"Active")===T)),S},[re,_,E,O,T,l,d]),Te=h.useMemo(()=>{const S=_e.length;if(S===0)return{total_employees:0,average_churn_probability:0,risk_levels:{high:0,medium:0,low:0},high_risk_count:0,medium_risk_count:0,low_risk_count:0};let P=0;const I={high:0,medium:0,low:0};for(const J of _e){const de=J.churnProbability||0;P+=de;const Be=l(de);Be==="High"?I.high++:Be==="Medium"?I.medium++:I.low++}const F=P/S;return{total_employees:S,average_churn_probability:F,risk_levels:I,high_risk_count:I.high,medium_risk_count:I.medium,low_risk_count:I.low}},[_e.length,_e,d]),gt=h.useMemo(()=>_e.length?[..._e].sort((S,P)=>{let I,F;switch(z){case"full_name":I=(S.full_name||"").toLowerCase(),F=(P.full_name||"").toLowerCase();break;case"structure_name":I=(S.structure_name||S.department||"").toLowerCase(),F=(P.structure_name||P.department||"").toLowerCase();break;case"position":I=(S.position||"").toLowerCase(),F=(P.position||"").toLowerCase();break;case"churnProbability":I=S.churnProbability||0,F=P.churnProbability||0;break;case"status":I=(S.status||"Active").toLowerCase(),F=(P.status||"Active").toLowerCase();break;case"riskLevel":const J={High:3,Medium:2,Low:1};I=J[l(S.churnProbability||0)]||0,F=J[l(P.churnProbability||0)]||0;break;default:return 0}return I<F?R==="asc"?-1:1:I>F?R==="asc"?1:-1:0}):[],[_e,z,R,d]),Tr=Ra({count:gt.length,getScrollElement:()=>q.current,estimateSize:()=>60,overscan:5}),Ge=h.useCallback(S=>{z===S?D(P=>P==="asc"?"desc":"asc"):B(S)},[z]),qe=({field:S})=>z!==S?null:R==="asc"?n.jsx(jt,{className:"w-4 h-4 ml-1"},`sort-icon-${S}-asc`):n.jsx(ut,{className:"w-4 h-4 ml-1"},`sort-icon-${S}-desc`),Gn=()=>n.jsx(wd,{}),qn=Ii(),Yn=S=>{qn(`/reasoning/${S.hr_code}`,{state:{employeeName:S.full_name}})};h.useEffect(()=>{const S=document.getElementById("model-training-indicator");S&&S.parentNode&&S.parentNode.removeChild(S),localStorage.removeItem("modelTrainingInProgress"),localStorage.removeItem("modelTrainingStartTime")},[]),h.useEffect(()=>{const S=localStorage.getItem("dataUploadNote");S&&(le(S),te(!0),localStorage.removeItem("dataUploadNote"))},[]);const Xn=h.useCallback(()=>{te(!1)},[]);return h.useEffect(()=>(K&&r&&r.length>0?tr.start(r):tr.stop(),()=>{tr.stop()}),[K,r]),e?K?n.jsxs("div",{className:"h-full flex flex-col p-6 bg-gray-50 dark:bg-gray-900",children:[H&&n.jsx(Pa,{show:H,onClose:()=>se(!1),onUploadSuccess:()=>{setTimeout(()=>{a(e.id,!0)},2e3)}}),n.jsx(Ea,{show:ee,message:X,onClose:Xn}),n.jsx("div",{className:"mb-6",children:Gn()}),n.jsx("div",{className:"mb-6",children:n.jsx(Ti,{})}),n.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-t-lg mb-6",children:n.jsx("div",{className:"flex space-x-6 px-6",children:n.jsxs("button",{onClick:()=>w("dashboard"),className:W("relative py-2 px-1 text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",u==="dashboard"?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[n.jsx("span",{className:"font-semibold",children:"Dashboard"}),u==="dashboard"&&n.jsx(Q.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400",layoutId:"activeTabIndicator",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]})})}),u==="dashboard"&&n.jsxs(n.Fragment,{children:[s&&n.jsx(Q.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dt,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 animate-pulse"}),n.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Enhancing data with AI reasoning..."})]}),n.jsx("div",{className:"flex-1 bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:n.jsx(Q.div,{className:"h-full bg-blue-500 dark:bg-blue-400 rounded-full",initial:{width:0},animate:{width:`${i}%`},transition:{duration:.3,ease:"easeOut"}})}),n.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium min-w-[3rem] text-right",children:[i,"%"]})]})}),n.jsxs(Q.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",initial:{opacity:0},animate:{opacity:1},transition:{staggerChildren:.1},children:[n.jsxs(Q.div,{className:W("bg-white dark:bg-gray-800/50 p-4 rounded-lg border h-full min-h-[90px]","border-gray-200/75 dark:border-gray-700/50 shadow-xs"),children:[n.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Average Churn Probability"}),n.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:[(Te.average_churn_probability*100).toFixed(1),"%"]})]}),n.jsx(sr,{title:"High Risk",count:Te.risk_levels.high,total:Te.total_employees,colorClass:"red"}),n.jsx(sr,{title:"Medium Risk",count:Te.risk_levels.medium,total:Te.total_employees,colorClass:"yellow"}),n.jsx(sr,{title:"Low Risk",count:Te.risk_levels.low,total:Te.total_employees,colorClass:"green"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-4",children:[n.jsxs("div",{className:"relative md:col-span-1 lg:col-span-2",children:[n.jsx(Ei,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),n.jsx(yi,{placeholder:"Search employees...",value:y,onChange:S=>N(S.target.value),className:"pl-9"})]}),n.jsxs(Re,{value:_,onValueChange:A,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:`All Departments (${Ce.length-1})`})}),n.jsx(be,{children:Ce.map(S=>n.jsx(Z,{value:S,children:S},S))})]}),n.jsxs(Re,{value:E,onValueChange:L,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:`All Positions (${Ue.length-1})`})}),n.jsx(be,{children:Ue.map(S=>n.jsx(Z,{value:S,children:S},S))})]}),n.jsxs(Re,{value:O,onValueChange:$,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:`All Risk Levels (${Ke.length-1})`})}),n.jsx(be,{children:Ke.map(S=>n.jsx(Z,{value:S,children:S},S))})]}),n.jsxs(Re,{value:T,onValueChange:V,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:"Active"})}),n.jsx(be,{children:Kn.map(S=>n.jsx(Z,{value:S,children:S},S))})]})]}),n.jsx("div",{ref:q,className:"flex-1 bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-auto min-h-0 border border-gray-200/75 dark:border-gray-700/50 relative",style:{maxHeight:"400px"},children:Y||G||gt.length===0?n.jsxs("div",{className:"flex items-center justify-center h-full min-h-[300px]",children:[Y&&n.jsx($a.PageLoading,{text:"Loading employee data..."}),G&&n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Error loading data"}),n.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:G})]}),!Y&&!G&&gt.length===0&&n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-gray-600 dark:text-gray-400 font-medium mb-2",children:"No employees found"}),n.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Try adjusting your filters or search criteria"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("table",{className:"w-full table-fixed border-collapse",children:n.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 sticky top-0 z-10",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-[20%]",children:n.jsxs("div",{className:"flex items-center",onClick:()=>Ge("full_name"),children:["Name ",n.jsx(qe,{field:"full_name"})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-[15%]",children:n.jsxs("div",{className:"flex items-center",onClick:()=>Ge("structure_name"),children:["Department ",n.jsx(qe,{field:"structure_name"})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-[15%]",children:n.jsxs("div",{className:"flex items-center",onClick:()=>Ge("position"),children:["Position ",n.jsx(qe,{field:"position"})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-[10%]",children:n.jsxs("div",{className:"flex items-center",onClick:()=>Ge("riskLevel"),children:["Risk ",n.jsx(qe,{field:"riskLevel"})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-[15%]",children:n.jsxs("div",{className:"flex items-center",onClick:()=>Ge("churnProbability"),children:["Churn % ",n.jsx(qe,{field:"churnProbability"})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-[10%]",children:n.jsxs("div",{className:"flex items-center",onClick:()=>Ge("status"),children:["Status ",n.jsx(qe,{field:"status"})]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 w-[15%]",children:"Actions"})]})})}),n.jsx("div",{className:"relative w-full",style:{height:`${Tr.getTotalSize()}px`},children:Tr.getVirtualItems().map(S=>{const P=gt[S.index];return P?n.jsx(bd,{employee:P,onReasoningClick:Yn,getRiskLevel:l,getRiskLevelWithStyles:c,style:{position:"absolute",top:0,left:0,width:"100%",height:`${S.size}px`,transform:`translateY(${S.start}px)`}},P.hr_code||S.index):null})})]})})]}),u==="network"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx(ic,{employees:_e,availableDepartments:Ce,isLoading:Y}),n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Only employees with at least two shared connections (2+ links) are displayed; relationship strength uses optional columns when present (e.g. age, work_location, remote_preference) and any missing values are ignored."})]}),u==="deep-analysis"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Select Analysis Type"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs(Q.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>v("churn-patterns"),className:W("p-4 border-2 rounded-lg transition-colors text-left",b==="churn-patterns"?"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400"),children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center mr-3",children:n.jsx(dt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),n.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Churn Pattern Analysis"})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Analyze churn reasoning data to identify patterns and risk factors across your organization."})]}),n.jsxs(Q.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-4 border-2 border-gray-200 dark:border-gray-700 rounded-lg hover:border-green-500 dark:hover:border-green-400 transition-colors text-left opacity-50 cursor-not-allowed",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mr-3",children:n.jsx(jt,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),n.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Engagement Correlation"})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Correlate engagement survey data with churn risk to identify satisfaction drivers."}),n.jsx("div",{className:"mt-2",children:n.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded",children:"Requires engagement data"})})]}),n.jsxs(Q.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-4 border-2 border-gray-200 dark:border-gray-700 rounded-lg hover:border-purple-500 dark:hover:border-purple-400 transition-colors text-left opacity-50 cursor-not-allowed",children:[n.jsxs("div",{className:"flex items-center mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center mr-3",children:n.jsx(ut,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),n.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Cross-Source Analysis"})]}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Comprehensive analysis combining churn, engagement, and interview data sources."}),n.jsx("div",{className:"mt-2",children:n.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded",children:"Requires multiple data sources"})})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Available Data Sources"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:W("flex items-center justify-between p-3 rounded-lg border transition-colors",ie?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"),children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:W("w-2 h-2 rounded-full mr-3",ie?"bg-green-500":"bg-gray-400")}),n.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Churn Reasoning Data"})]}),n.jsx("span",{className:W("text-sm",ie?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"),children:ie?"Available":"Not available"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mr-3"}),n.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Engagement Survey Data"})]}),n.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Not uploaded"})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mr-3"}),n.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Interview Data"})]}),n.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Not uploaded"})]})]}),n.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:n.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[n.jsx("strong",{children:"💡 Tip:"})," Upload engagement survey data in the Data Management section to unlock advanced correlation analysis capabilities."]})})]}),n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Analysis Configuration"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Department Filter"}),n.jsxs(Re,{value:m.departmentFilter,onValueChange:S=>p(P=>({...P,departmentFilter:S})),disabled:!b,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:"All Departments"})}),n.jsxs(be,{children:[n.jsx(Z,{value:"all-departments",children:"All Departments"}),Ce.filter(S=>S!=="All").map(S=>n.jsx(Z,{value:S,children:S},S))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Time Period"}),n.jsxs(Re,{value:m.timePeriod,onValueChange:S=>p(P=>({...P,timePeriod:S})),disabled:!b,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:"Last 12 months"})}),n.jsxs(be,{children:[n.jsx(Z,{value:"last-3-months",children:"Last 3 months"}),n.jsx(Z,{value:"last-6-months",children:"Last 6 months"}),n.jsx(Z,{value:"last-12-months",children:"Last 12 months"}),n.jsx(Z,{value:"last-24-months",children:"Last 24 months"}),n.jsx(Z,{value:"all-time",children:"All time"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Risk Level"}),n.jsxs(Re,{value:m.riskLevel,onValueChange:S=>p(P=>({...P,riskLevel:S})),disabled:!b,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:"All Risk Levels"})}),n.jsxs(be,{children:[n.jsx(Z,{value:"all-risk-levels",children:"All Risk Levels"}),n.jsx(Z,{value:"High",children:"High Risk"}),n.jsx(Z,{value:"Medium",children:"Medium Risk"}),n.jsx(Z,{value:"Low",children:"Low Risk"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Employee Group"}),n.jsxs(Re,{value:m.employeeGroup,onValueChange:S=>p(P=>({...P,employeeGroup:S})),disabled:!b,children:[n.jsx(ve,{children:n.jsx(Ae,{placeholder:"All Employees"})}),n.jsxs(be,{children:[n.jsx(Z,{value:"all-employees",children:"All Employees"}),n.jsx(Z,{value:"new-hires",children:"New Hires (< 1 year)"}),n.jsx(Z,{value:"experienced",children:"Experienced (1-5 years)"}),n.jsx(Z,{value:"senior",children:"Senior (> 5 years)"}),n.jsx(Z,{value:"high-performers",children:"High Performers"}),n.jsx(Z,{value:"at-risk",children:"At Risk Employees"})]})]})]})]}),n.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[n.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:b?`Ready to analyze ${b.replace("-"," ")} with current filters`:"Select an analysis type to configure parameters"}),n.jsx("button",{disabled:!b||x,onClick:async()=>{if(b){j(!0);try{const S=ws();let P=_e;m.departmentFilter&&m.departmentFilter!=="all-departments"&&(P=P.filter(F=>(F.structure_name||F.department||"Unassigned")===m.departmentFilter)),m.riskLevel&&m.riskLevel!=="all-risk-levels"&&(P=P.filter(F=>l(F.churnProbability||0)===m.riskLevel)),m.employeeGroup&&m.employeeGroup!=="all-employees"&&(P=P.filter(F=>{switch(m.employeeGroup){case"new-hires":return(F.tenure_years||0)<1;case"experienced":return(F.tenure_years||0)>=1&&(F.tenure_years||0)<=5;case"senior":return(F.tenure_years||0)>5;case"high-performers":return(F.performance||"0").includes("4")||(F.performance||"0").includes("5");case"at-risk":return(F.churnProbability||0)>=S.highRisk;default:return!0}}));let I;switch(b){case"churn-patterns":I=await fd(P,S);break;case"engagement-correlation":I=await pd(P);break;case"organizational-insights":I=await gd(P,Ce,Te);break;case"cross-source":I=await xd(P);break;default:I=await yd(b,P)}C(I)}catch(S){C({id:"error",type:b,title:"Analysis Failed",summary:`Failed to complete ${b.replace("-"," ")} analysis. ${S instanceof Error?S.message:"Unknown error occurred."}`,insights:[],visualizations:[],recommendations:[],confidence:0,timestamp:new Date,dataSources:[],parameters:m,executionTime:0})}finally{j(!1)}}},className:W("px-6 py-2 rounded-lg font-medium transition-all flex items-center space-x-2",b&&!x?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-400 dark:bg-gray-600 text-white cursor-not-allowed"),children:x?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),n.jsx("span",{children:"Running Analysis..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(dt,{className:"w-4 h-4"}),n.jsx("span",{children:"Run Analysis"})]})})]})]}),k&&n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Analysis Results"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[n.jsxs("span",{children:["Confidence: ",(k.confidence*100).toFixed(0),"%"]}),n.jsx("span",{children:"•"}),n.jsx("span",{children:k.timestamp.toLocaleString()})]})]}),n.jsx(Fa,{result:k,onExport:S=>{const P={title:k.title,summary:k.summary,confidence:`${Math.round(k.confidence*100)}%`,timestamp:k.timestamp.toLocaleString(),insights:k.insights.map(I=>({title:I.title,description:I.description,severity:I.severity,confidence:I.confidence})),recommendations:k.recommendations?.map(I=>({title:I.title,description:I.description,priority:I.priority,timeframe:I.timeframe}))||[],parameters:k.parameters};if(S==="pdf"){const I=`
                      <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 800px;">
                        <h1 style="color: #1f2937; margin-bottom: 20px;">${P.title}</h1>
                        
                        <div style="margin-bottom: 20px;">
                          <p><strong>Summary:</strong> ${P.summary}</p>
                          <p><strong>Confidence:</strong> ${P.confidence}</p>
                          <p><strong>Generated:</strong> ${P.timestamp}</p>
                        </div>
                        
                        <h2 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Key Insights</h2>
                        ${P.insights.map(J=>`
                          <div style="margin-bottom: 20px; padding: 15px; background-color: #f9fafb; border-radius: 8px;">
                            <h3 style="color: #1f2937; margin: 0 0 10px 0;">${J.title}</h3>
                            <p style="margin: 0 0 10px 0; color: #4b5563;">${J.description}</p>
                            <p style="margin: 0; font-size: 14px; color: #6b7280;">
                              <strong>Severity:</strong> ${J.severity} | <strong>Confidence:</strong> ${Math.round(J.confidence*100)}%
                            </p>
                          </div>
                        `).join("")}
                        
                        <h2 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Recommendations</h2>
                        ${P.recommendations.map(J=>`
                          <div style="margin-bottom: 20px; padding: 15px; background-color: #f9fafb; border-radius: 8px;">
                            <h3 style="color: #1f2937; margin: 0 0 10px 0;">${J.title}</h3>
                            <p style="margin: 0 0 10px 0; color: #4b5563;">${J.description}</p>
                            <p style="margin: 0; font-size: 14px; color: #6b7280;">
                              <strong>Priority:</strong> ${J.priority} | <strong>Timeframe:</strong> ${J.timeframe}
                            </p>
                          </div>
                        `).join("")}
                      </div>
                    `,F=document.createElement("div");F.innerHTML=I,F.style.position="absolute",F.style.left="-9999px",F.style.top="0",document.body.appendChild(F),$r(()=>import("./html2canvas.esm-BfxBtG_O.js"),[]).then(J=>{J.default(F,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"}).then(de=>{$r(()=>import("./jspdf.es.min-CydSDO_4.js"),__vite__mapDeps([0,1,2,3,4,5])).then(Be=>{const{jsPDF:ue}=Be,it=new ue("p","mm","a4"),Zn=de.toDataURL("image/png"),Dr=it.internal.pageSize.getWidth(),Jn=de.height*Dr/de.width;it.addImage(Zn,"PNG",0,0,Dr,Jn),it.save(`churn-analysis-${new Date().toISOString().split("T")[0]}.pdf`)})})}).catch(J=>{alert("PDF generation failed. Please try again.")}).finally(()=>{document.body.removeChild(F)})}else if(S==="excel"){const F=[["Analysis Report",""],["Title",P.title],["Summary",P.summary],["Confidence",P.confidence],["Generated",P.timestamp],["",""],["Key Insights",""],["Title","Description","Severity","Confidence"],...P.insights.map(ue=>[ue.title,ue.description,ue.severity,`${Math.round(ue.confidence*100)}%`]),["",""],["Recommendations",""],["Title","Description","Priority","Timeframe"],...P.recommendations.map(ue=>[ue.title,ue.description,ue.priority,ue.timeframe])].map(ue=>ue.map(it=>`"${String(it).replace(/"/g,'""')}"`).join(",")).join(`
`),J=new Blob([F],{type:"text/csv;charset=utf-8;"}),de=document.createElement("a"),Be=URL.createObjectURL(J);de.setAttribute("href",Be),de.setAttribute("download",`churn-analysis-${new Date().toISOString().split("T")[0]}.csv`),de.style.visibility="hidden",document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(Be)}},onDrillDown:S=>{}})]})]})]}):n.jsx(Oi,{status:o?.status,message:o?.message}):n.jsx("div",{className:"h-full w-full flex items-center justify-center text-center p-6 bg-gray-50 dark:bg-gray-900",style:{minHeight:"400px",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9fafb",border:"1px solid #e5e7eb"},children:n.jsxs("div",{children:[n.jsx(Pi,{className:"mx-auto h-16 w-16 text-gray-400 dark:text-gray-600 mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"No Project Active"}),n.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Please select or create a project to view the dashboard."})]})})}export{Rd as Home,Rd as default};
//# sourceMappingURL=Home-0abksWmx.js.map
